<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2020 | RJW&#39;s Notebook</title>
    <meta name="generator" content="VuePress 1.5.3">
    <link rel="icon" href="/Notebook/images/logo.png">
    <meta name="description" content="ğŸ“æ¯å¤©è®°å½•ä¸€ç‚¹ç‚¹">
    <link rel="preload" href="/Notebook/assets/css/0.styles.2568425a.css" as="style"><link rel="preload" href="/Notebook/assets/js/app.51035dcd.js" as="script"><link rel="preload" href="/Notebook/assets/js/21.b8066a1d.js" as="script"><link rel="preload" href="/Notebook/assets/js/15.b864e6b5.js" as="script"><link rel="preload" href="/Notebook/assets/js/19.17673ac2.js" as="script"><link rel="prefetch" href="/Notebook/assets/js/2.f187326d.js"><link rel="prefetch" href="/Notebook/assets/js/3.c107e9cc.js"><link rel="prefetch" href="/Notebook/assets/js/4.195f4b4c.js"><link rel="prefetch" href="/Notebook/assets/js/5.c6e81d81.js"><link rel="prefetch" href="/Notebook/assets/js/6.f1072f55.js"><link rel="prefetch" href="/Notebook/assets/js/7.d4af47ef.js"><link rel="prefetch" href="/Notebook/assets/js/8.c5c9a92a.js"><link rel="prefetch" href="/Notebook/assets/js/9.6d199ed1.js"><link rel="prefetch" href="/Notebook/assets/js/10.88896875.js"><link rel="prefetch" href="/Notebook/assets/js/11.bcd53a24.js"><link rel="prefetch" href="/Notebook/assets/js/12.1b5a4e8c.js"><link rel="prefetch" href="/Notebook/assets/js/13.356cc3d0.js"><link rel="prefetch" href="/Notebook/assets/js/14.2c74c350.js"><link rel="prefetch" href="/Notebook/assets/js/16.30e2be76.js"><link rel="prefetch" href="/Notebook/assets/js/17.beaf0e2c.js"><link rel="prefetch" href="/Notebook/assets/js/18.13b949a3.js"><link rel="prefetch" href="/Notebook/assets/js/20.5e336d91.js">
    <link rel="stylesheet" href="/Notebook/assets/css/0.styles.2568425a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Notebook/" class="home-link router-link-active"><!----> <span class="site-name">RJW's Notebook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Notebook/dailyRecord/" class="nav-link router-link-active">
  ğŸ“æ—¥å¸¸è®°å½•
</a></div><div class="nav-item"><a href="/Notebook/bookmark/" class="nav-link">
  ğŸ·ä¹¦ç­¾æ•´ç†
</a></div><div class="nav-item"><a href="/Notebook/lint/" class="nav-link">
  âœ”ï¸ç¼–ç è§„èŒƒ&amp;ååŒå¼€å‘
</a></div><div class="nav-item"><a href="http://shooterblog.site/Learn-JS-Demo/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ“–çŸ¥è¯†è„‘å›¾
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://shooterblog.site" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ”§ä¸ªäººåšå®¢
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/shooterRao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ”—Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Notebook/dailyRecord/" class="nav-link router-link-active">
  ğŸ“æ—¥å¸¸è®°å½•
</a></div><div class="nav-item"><a href="/Notebook/bookmark/" class="nav-link">
  ğŸ·ä¹¦ç­¾æ•´ç†
</a></div><div class="nav-item"><a href="/Notebook/lint/" class="nav-link">
  âœ”ï¸ç¼–ç è§„èŒƒ&amp;ååŒå¼€å‘
</a></div><div class="nav-item"><a href="http://shooterblog.site/Learn-JS-Demo/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ“–çŸ¥è¯†è„‘å›¾
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://shooterblog.site" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ”§ä¸ªäººåšå®¢
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/shooterRao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ”—Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>æ—¥å¸¸è®°å½•</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Notebook/dailyRecord/" aria-current="page" class="sidebar-link">2022</a></li><li><a href="/Notebook/dailyRecord/2021.html" class="sidebar-link">2021</a></li><li><a href="/Notebook/dailyRecord/2020.html" aria-current="page" class="active sidebar-link">2020</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#ä¸€æœˆ" class="sidebar-link">ä¸€æœˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#è¿è¡Œæ—¶è®¾ç½®-webpack-çš„-publicpath" class="sidebar-link">è¿è¡Œæ—¶è®¾ç½® webpack çš„ publicPath</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#äºŒæœˆ" class="sidebar-link">äºŒæœˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#å¤§æ–‡ä»¶ä¸Šä¼ åˆ‡ç‰‡æ–¹æ³•" class="sidebar-link">å¤§æ–‡ä»¶ä¸Šä¼ åˆ‡ç‰‡æ–¹æ³•</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#javascript-åˆ¤æ–­æ•´å‹çš„æ–¹æ³•" class="sidebar-link">JavaScript åˆ¤æ–­æ•´å‹çš„æ–¹æ³•</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#å¦‚ä½•åœ¨-html-ä¸Šå®ç°é‡å®šå‘ï¼Ÿ" class="sidebar-link">å¦‚ä½•åœ¨ html ä¸Šå®ç°é‡å®šå‘ï¼Ÿ</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#ä¸‰æœˆ" class="sidebar-link">ä¸‰æœˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#docker-nginx-å®¹å™¨å¦‚ä½•è®¿é—®å®¿ä¸»æœº" class="sidebar-link">docker nginx å®¹å™¨å¦‚ä½•è®¿é—®å®¿ä¸»æœº</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#vscode-vue-æ–‡ä»¶ä¸­æ— æ³•è¯†åˆ«-xxx-æ–‡ä»¶è·¯å¾„" class="sidebar-link">vscode vue æ–‡ä»¶ä¸­æ— æ³•è¯†åˆ«&quot;@/xxx&quot;æ–‡ä»¶è·¯å¾„</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#ä½¿ç”¨å¯¹è±¡å¡«å……æ•°ç»„" class="sidebar-link">ä½¿ç”¨å¯¹è±¡å¡«å……æ•°ç»„</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#å››æœˆ" class="sidebar-link">å››æœˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#å¦‚ä½•è®¾è®¡ä¸€ä¸ªåŒæ—¶æ”¯æŒå…·åæ’æ§½å’Œé»˜è®¤æ’æ§½çš„-vue-ç»„ä»¶" class="sidebar-link">å¦‚ä½•è®¾è®¡ä¸€ä¸ªåŒæ—¶æ”¯æŒå…·åæ’æ§½å’Œé»˜è®¤æ’æ§½çš„ vue ç»„ä»¶</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#å¦‚ä½•åœ¨-eslintrc-js-ä¸­é…ç½®-prettier-è§„åˆ™" class="sidebar-link">å¦‚ä½•åœ¨ .eslintrc.js ä¸­é…ç½® prettier è§„åˆ™</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#ä½¿ç”¨-emoji-è®¾ç½®-ç½‘é¡µçš„-favicon-çš„æ–¹æ³•" class="sidebar-link">ä½¿ç”¨ emoji è®¾ç½® ç½‘é¡µçš„ favicon çš„æ–¹æ³•</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#è®¡ç®—-scrollbar-å®½åº¦çš„æ–¹æ³•" class="sidebar-link">è®¡ç®— scrollbar å®½åº¦çš„æ–¹æ³•</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#pipe-promise" class="sidebar-link">pipe-promise</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#äº”æœˆ" class="sidebar-link">äº”æœˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#iview-modal-ç»„ä»¶-slot-é‡æ¸²æŸ“" class="sidebar-link">iview Modal ç»„ä»¶ slot é‡æ¸²æŸ“</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#å¦‚ä½•ç”¨-this-xxx-æ–¹å¼æŒ‚è½½-vue-ç»„ä»¶" class="sidebar-link">å¦‚ä½•ç”¨ this.\\\$xxx æ–¹å¼æŒ‚è½½ vue ç»„ä»¶</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#å…­æœˆ" class="sidebar-link">å…­æœˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#typescript-ä¸­çš„å…ƒç»„" class="sidebar-link">typeScript ä¸­çš„å…ƒç»„</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#yarn-link-å‡ºç°-permission-denied" class="sidebar-link">yarn link å‡ºç° permission denied</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#object-is-polyfill" class="sidebar-link">Object.is polyfill</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#yarn-link-ä¹‹åå¯æ‰§è¡Œå‘½ä»¤å­˜åœ¨å“ªé‡Œ" class="sidebar-link">yarn link ä¹‹åå¯æ‰§è¡Œå‘½ä»¤å­˜åœ¨å“ªé‡Œ</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#ä¸ƒæœˆ" class="sidebar-link">ä¸ƒæœˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#è½¬è¯‘å‡½æ•°" class="sidebar-link">è½¬è¯‘å‡½æ•°</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#nodejs-ä¸€äº›è·¯å¾„å˜é‡" class="sidebar-link">nodejs ä¸€äº›è·¯å¾„å˜é‡</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#æ¨¡å—é‡å®šå‘" class="sidebar-link">æ¨¡å—é‡å®šå‘</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#ts-ä½¿ç”¨-fs-promises" class="sidebar-link">ts ä½¿ç”¨ fs.promises</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#æŸ¥çœ‹è¿œç¨‹-npm-åŒ…æœ€æ–°ç‰ˆæœ¬" class="sidebar-link">æŸ¥çœ‹è¿œç¨‹ npm åŒ…æœ€æ–°ç‰ˆæœ¬</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#docker-nginx-å®¹å™¨-hjson-ä¸­æ–‡ä¹±ç " class="sidebar-link">docker nginx å®¹å™¨ hjson ä¸­æ–‡ä¹±ç </a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#è·å–é¡¹ç›®éƒ¨ç½²è·¯å¾„" class="sidebar-link">è·å–é¡¹ç›®éƒ¨ç½²è·¯å¾„</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#nodejs-åˆ¤æ–­æ–‡ä»¶æˆ–è€…ç›®å½•æ˜¯å¦å­˜åœ¨çš„" class="sidebar-link">nodejs åˆ¤æ–­æ–‡ä»¶æˆ–è€…ç›®å½•æ˜¯å¦å­˜åœ¨çš„</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#nodejs-é›†ä½“å¯¼å‡ºæ¨¡å—çš„æ–¹æ³•" class="sidebar-link">nodejs é›†ä½“å¯¼å‡ºæ¨¡å—çš„æ–¹æ³•</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#å…«æœˆ" class="sidebar-link">å…«æœˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#docker-å¦‚ä½•ä¸ä½¿ç”¨ç¼“å­˜é‡å»ºé•œåƒ" class="sidebar-link">docker å¦‚ä½•ä¸ä½¿ç”¨ç¼“å­˜é‡å»ºé•œåƒ</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#åˆ¤æ–­ç©ºå¯¹è±¡çš„æ–¹æ³•" class="sidebar-link">åˆ¤æ–­ç©ºå¯¹è±¡çš„æ–¹æ³•</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#es6-åˆ¤æ–­-2-ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰" class="sidebar-link">ES6 åˆ¤æ–­ 2 ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#è¿‡æ»¤å¯¹è±¡æŸä¸ª-key-å€¼" class="sidebar-link">è¿‡æ»¤å¯¹è±¡æŸä¸ª key å€¼</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#babel-æ˜¯æ€ä¹ˆå®ç°-const-å’Œ-let-å—çº§ä½œç”¨åŸŸçš„" class="sidebar-link">babel æ˜¯æ€ä¹ˆå®ç° const å’Œ let å—çº§ä½œç”¨åŸŸçš„</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#ts-get-å‡½æ•°æ­£ç¡®å†™æ³•" class="sidebar-link">ts get å‡½æ•°æ­£ç¡®å†™æ³•</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#nodejs-æ‹‰å–è¿œç«¯å›¾ç‰‡ä¿å­˜æœ¬åœ°åŸºç¡€å†™æ³•" class="sidebar-link">nodejs æ‹‰å–è¿œç«¯å›¾ç‰‡ä¿å­˜æœ¬åœ°åŸºç¡€å†™æ³•</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#ä¹æœˆ" class="sidebar-link">ä¹æœˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#æµè§ˆå™¨å¦‚ä½•æ£€æµ‹ç³»ç»Ÿä¸»é¢˜è‰²" class="sidebar-link">æµè§ˆå™¨å¦‚ä½•æ£€æµ‹ç³»ç»Ÿä¸»é¢˜è‰²</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#å‰ç«¯å¦‚ä½•ä¸‹è½½-base64-å­—ç¬¦ä¸²å›¾ç‰‡" class="sidebar-link">å‰ç«¯å¦‚ä½•ä¸‹è½½ base64 å­—ç¬¦ä¸²å›¾ç‰‡</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#ç”ŸæˆåŒºé—´çš„éšæœºæ•°" class="sidebar-link">ç”ŸæˆåŒºé—´çš„éšæœºæ•°</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#chrome-å¼€å¯-pause-on-exceptions" class="sidebar-link">chrome å¼€å¯ pause on exceptions</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#åæœˆ" class="sidebar-link">åæœˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#æŸ¥çœ‹é¡¹ç›®-node-modules-æ–‡ä»¶å¤¹å¤§å°" class="sidebar-link">æŸ¥çœ‹é¡¹ç›® node_modules æ–‡ä»¶å¤¹å¤§å°</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#vue-devtool-æ— æ³•æ˜¾ç¤ºä½¿ç”¨-mount-åŠ¨æ€æŒ‚è½½çš„ç»„ä»¶è§£å†³æ–¹æ³•" class="sidebar-link">vue-devtool æ— æ³•æ˜¾ç¤ºä½¿ç”¨ $mount åŠ¨æ€æŒ‚è½½çš„ç»„ä»¶è§£å†³æ–¹æ³•</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#æœ¬åœ°å›¾ç‰‡é¢„è§ˆ" class="sidebar-link">æœ¬åœ°å›¾ç‰‡é¢„è§ˆ</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#nginx-å¼€å¯è´Ÿè½½å‡è¡¡" class="sidebar-link">nginx å¼€å¯è´Ÿè½½å‡è¡¡</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#ä¸€è¡Œä»£ç å®ç°è¯„åˆ†ç»„ä»¶" class="sidebar-link">ä¸€è¡Œä»£ç å®ç°è¯„åˆ†ç»„ä»¶</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#åä¸€æœˆ" class="sidebar-link">åä¸€æœˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#nodejs-ä¸€äº›è·¯å¾„å¸¸è¯†" class="sidebar-link">nodejs ä¸€äº›è·¯å¾„å¸¸è¯†</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#åœ¨-node-ä¸­ä¸èƒ½ä½¿ç”¨exports-xxxçš„åŸå› " class="sidebar-link">åœ¨ node ä¸­ä¸èƒ½ä½¿ç”¨exports=xxxçš„åŸå› </a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#isnan-å’Œ-number-isnan-çš„åŒºåˆ«" class="sidebar-link">isNaN å’Œ Number.isNaN çš„åŒºåˆ«</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#chrome-devtool-network-è¯·æ±‚æ—¶åºä¿¡æ¯" class="sidebar-link">chrome devtool network è¯·æ±‚æ—¶åºä¿¡æ¯</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#å…³äºvueçš„keyå‡ ä¸ªé—®é¢˜è®¨è®º" class="sidebar-link">å…³äºvueçš„keyå‡ ä¸ªé—®é¢˜è®¨è®º</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#vue-diffç®—æ³•ç›¸å…³åˆ†æ" class="sidebar-link">vue diffç®—æ³•ç›¸å…³åˆ†æ</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#åäºŒæœˆ" class="sidebar-link">åäºŒæœˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#base64æ˜¯ä»€ä¹ˆï¼Ÿ" class="sidebar-link">base64æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#å¼‚æ­¥æ¨¡å—æ‰“åŒ…æ‰§è¡Œæµç¨‹" class="sidebar-link">å¼‚æ­¥æ¨¡å—æ‰“åŒ…æ‰§è¡Œæµç¨‹</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#webpack-æ¨¡å—åœ¨è¿è¡Œæ—¶æ˜¯æ€ä¹ˆå­˜çš„ï¼Ÿ" class="sidebar-link">webpack æ¨¡å—åœ¨è¿è¡Œæ—¶æ˜¯æ€ä¹ˆå­˜çš„ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#webpack-æŒä¹…åŒ–-chunk-ç¼“å­˜æ–¹æ¡ˆ" class="sidebar-link">webpack æŒä¹…åŒ– chunk ç¼“å­˜æ–¹æ¡ˆ</a></li><li class="sidebar-sub-header"><a href="/Notebook/dailyRecord/2020.html#å¦‚æœè·å–é¡µé¢fpå’Œfcpçš„æ—¶é—´" class="sidebar-link">å¦‚æœè·å–é¡µé¢FPå’ŒFCPçš„æ—¶é—´</a></li></ul></li></ul></li><li><a href="/Notebook/dailyRecord/2019.html" class="sidebar-link">2019</a></li><li><a href="/Notebook/dailyRecord/2018.html" class="sidebar-link">2018</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>interview</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Notebook/dailyRecord/interview.html" class="sidebar-link">é¢è¯•å¤ä¹ </a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_2020"><a href="#_2020" aria-hidden="true" class="header-anchor">#</a> 2020</h1> <h2 id="ä¸€æœˆ"><a href="#ä¸€æœˆ" aria-hidden="true" class="header-anchor">#</a> ä¸€æœˆ</h2> <h3 id="è¿è¡Œæ—¶è®¾ç½®-webpack-çš„-publicpath"><a href="#è¿è¡Œæ—¶è®¾ç½®-webpack-çš„-publicpath" aria-hidden="true" class="header-anchor">#</a> è¿è¡Œæ—¶è®¾ç½® webpack çš„ publicPath</h3> <p><code>publicPath</code> æ˜¯ webpack æä¾›çš„é…ç½®å…¬å…±è·¯å¾„çš„åœ°æ–¹ï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥æŒ‡å®šåº”ç”¨ç¨‹åºä¸­æ‰€æœ‰èµ„æºçš„åŸºç¡€è·¯å¾„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è¿è¡Œæ—¶è®¾ç½®<code>publicPath</code>ï¼Œå¯ä»¥é€šè¿‡åŠ¨æ€è®¾ç½®<code>__webpack_public_path__</code>æ¥å®ç°</p> <p>åœ¨<code>app.js</code>ä¸­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>__webpack_public_path__ <span class="token operator">=</span> <span class="token string">'/public/'</span><span class="token punctuation">;</span>

<span class="token comment">// æ‰“åŒ…åå¯¹åº”çš„å˜é‡å</span>
__webpack_require__<span class="token punctuation">.</span>p <span class="token operator">=</span> <span class="token string">'/public/'</span><span class="token punctuation">;</span>
</code></pre></div><p>åœ¨æ‰“åŒ…åï¼Œä¼šæœ‰ä¸€ä¸ª<code>__webpack_require__.p</code>å˜é‡æ¥ä¿å­˜æœ€æ–°è®¾ç½®çš„å€¼</p> <h2 id="äºŒæœˆ"><a href="#äºŒæœˆ" aria-hidden="true" class="header-anchor">#</a> äºŒæœˆ</h2> <h3 id="å¤§æ–‡ä»¶ä¸Šä¼ åˆ‡ç‰‡æ–¹æ³•"><a href="#å¤§æ–‡ä»¶ä¸Šä¼ åˆ‡ç‰‡æ–¹æ³•" aria-hidden="true" class="header-anchor">#</a> å¤§æ–‡ä»¶ä¸Šä¼ åˆ‡ç‰‡æ–¹æ³•</h3> <p>å‰ç«¯ä¸Šä¼ æ‰“æ–‡ä»¶çš„æ—¶å€™ï¼Œä¸€èˆ¬éƒ½ä¼šç”¨åˆ‡ç‰‡ä¸Šä¼ çš„æ–¹å¼ï¼Œæ ¸å¿ƒä¸»è¦æ˜¯ç”¨<code>Blob.prototype.slice</code>è¿›è¡Œåˆ‡ç‰‡ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥è¿”å›ä¸€ä¸ªæ–°çš„åˆ‡ç‰‡<code>Blob</code>å¯¹è±¡ï¼Œå‰ç«¯å¤„ç†è¿™ä¹ˆå†™ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createFileChunk</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> fileChunkList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> cur <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>cur <span class="token operator">&lt;</span> file<span class="token punctuation">.</span>size<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fileChunkList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// åˆ©ç”¨ Blob.prototype.slice åˆ‡ç‰‡</span>
      file<span class="token punctuation">:</span> file<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>cur<span class="token punctuation">,</span> cur <span class="token operator">+</span> size<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cur <span class="token operator">+=</span> size<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> fileChunkList<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="javascript-åˆ¤æ–­æ•´å‹çš„æ–¹æ³•"><a href="#javascript-åˆ¤æ–­æ•´å‹çš„æ–¹æ³•" aria-hidden="true" class="header-anchor">#</a> JavaScript åˆ¤æ–­æ•´å‹çš„æ–¹æ³•</h3> <p>es5ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isInteger</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">===</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>es6ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isInteger</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Number<span class="token punctuation">.</span><span class="token function">isInteger</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å¦‚ä½•åœ¨-html-ä¸Šå®ç°é‡å®šå‘ï¼Ÿ"><a href="#å¦‚ä½•åœ¨-html-ä¸Šå®ç°é‡å®šå‘ï¼Ÿ" aria-hidden="true" class="header-anchor">#</a> å¦‚ä½•åœ¨ html ä¸Šå®ç°é‡å®šå‘ï¼Ÿ</h3> <p>ä½¿ç”¨<code>meta content url</code>æ–¹æ³•ï¼Œ<code>http-equiv=&quot;refresh&quot;</code>å®šä¹‰æ–‡æ¡£è‡ªåŠ¨åˆ·æ–°çš„æ—¶é—´é—´éš”(å¤šå°‘ç§’)ï¼Œè®¾ç½®åœ¨<code>content</code>é‡Œ<code>url</code>çš„å‰é¢</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>refresh<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>0;url=xxx<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="ä¸‰æœˆ"><a href="#ä¸‰æœˆ" aria-hidden="true" class="header-anchor">#</a> ä¸‰æœˆ</h2> <h3 id="docker-nginx-å®¹å™¨å¦‚ä½•è®¿é—®å®¿ä¸»æœº"><a href="#docker-nginx-å®¹å™¨å¦‚ä½•è®¿é—®å®¿ä¸»æœº" aria-hidden="true" class="header-anchor">#</a> docker nginx å®¹å™¨å¦‚ä½•è®¿é—®å®¿ä¸»æœº</h3> <p>åœ¨ç”¨ docker nginx è¿›è¡Œåå‘ä»£ç†æœ¬åœ°ä¸€äº›æœåŠ¡çš„æ—¶å€™ï¼Œé»˜è®¤ç”¨ localhost æ˜¯ç›´æ¥è®¿é—®å®¹å™¨çš„æœ¬èº«ï¼Œæ‰€ä»¥è¦åœ¨ nginx çš„ conf æ–‡ä»¶ä¸­é…ç½®æŒ‡å®šçš„ ip åœ°å€ï¼Œä½†æ˜¯ç½‘ç»œåˆ‡æ¢çš„è¯ï¼Œip ä¼šå˜ï¼Œæ‰€ä»¥åªèƒ½ä¿®æ”¹é…ç½®æ–‡ä»¶è¿›è¡Œé‡å¯è¿™ä¸ªå®¹å™¨ï¼Œå…¶å®ä¸æ–¹ä¾¿ï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥çœå»è¿™æ­¥éª¤å‘¢ï¼Ÿ</p> <ul><li>åœ¨ mac desktop ç¯å¢ƒä¸­ï¼Œå¯ä»¥ç”¨<code>host.docker.internal</code>æ¥è·å–åˆ°å®¿ä¸»æœºçš„ ip åœ°å€</li> <li>åœ¨ linux ç¯å¢ƒä¸­ï¼Œå¯ä»¥<code>--network host</code>æ¨¡å¼å¯åŠ¨å®¹å™¨</li></ul> <p>åœ¨ mac ç¯å¢ƒä¸­ï¼Œnginx çš„ conf æ–‡ä»¶ä¸­å¯ä»¥è¿™ä¹ˆå†™äº†ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>location / {
  proxy_pass http://host.docker.internal:5505/;
}
</code></pre></div><h3 id="vscode-vue-æ–‡ä»¶ä¸­æ— æ³•è¯†åˆ«-xxx-æ–‡ä»¶è·¯å¾„"><a href="#vscode-vue-æ–‡ä»¶ä¸­æ— æ³•è¯†åˆ«-xxx-æ–‡ä»¶è·¯å¾„" aria-hidden="true" class="header-anchor">#</a> vscode vue æ–‡ä»¶ä¸­æ— æ³•è¯†åˆ«&quot;@/xxx&quot;æ–‡ä»¶è·¯å¾„</h3> <p>ä½¿ç”¨ <code>jsconfig.json</code> è§£å†³</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;baseUrl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;paths&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;@/*&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./src/*&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;g6/*&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./src/g6/*&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ES6&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commonjs&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;allowSyntheticDefaultImports&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;include&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/**/*&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;exclude&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ä½¿ç”¨å¯¹è±¡å¡«å……æ•°ç»„"><a href="#ä½¿ç”¨å¯¹è±¡å¡«å……æ•°ç»„" aria-hidden="true" class="header-anchor">#</a> ä½¿ç”¨å¯¹è±¡å¡«å……æ•°ç»„</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> length <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> resultA <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token punctuation">{</span> length <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> resultB <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

resultA<span class="token punctuation">;</span> <span class="token comment">// =&gt; [{}, {}, {}]</span>
resultB<span class="token punctuation">;</span> <span class="token comment">// =&gt; [{}, {}, {}]</span>

resultA<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> resultA<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; false</span>
resultB<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> resultB<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; true</span>
</code></pre></div><p>ç”±æ­¤å¯è§ï¼Œç”¨<code>Array.from</code>æ¯”<code>fill</code>æ–¹æ³•æ›´å¥½ï¼Œå¯ä»¥é¿å…ç”±äºç›¸åŒå¯¹è±¡å¼•èµ·çš„ä¸€äº›éº»çƒ¦ã€‚</p> <h2 id="å››æœˆ"><a href="#å››æœˆ" aria-hidden="true" class="header-anchor">#</a> å››æœˆ</h2> <h3 id="å¦‚ä½•è®¾è®¡ä¸€ä¸ªåŒæ—¶æ”¯æŒå…·åæ’æ§½å’Œé»˜è®¤æ’æ§½çš„-vue-ç»„ä»¶"><a href="#å¦‚ä½•è®¾è®¡ä¸€ä¸ªåŒæ—¶æ”¯æŒå…·åæ’æ§½å’Œé»˜è®¤æ’æ§½çš„-vue-ç»„ä»¶" aria-hidden="true" class="header-anchor">#</a> å¦‚ä½•è®¾è®¡ä¸€ä¸ªåŒæ—¶æ”¯æŒå…·åæ’æ§½å’Œé»˜è®¤æ’æ§½çš„ vue ç»„ä»¶</h3> <p>å¦‚æœæƒ³è¦å¼€å‘ä¸€ä¸ªåŒæ—¶æ”¯æŒå…·ä½“æ’æ§½å’Œé»˜è®¤æ’æ§½çš„ vue ç»„ä»¶ï¼Œå…³é”®åœ¨äºå¦‚ä½•åˆ¤æ–­ç»„ä»¶æ˜¯å¦ä½¿ç”¨äº†é»˜è®¤æ’æ§½ï¼Œä¹Ÿå°±æ˜¯åŠ ä¸ªåˆ¤æ–­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token function">hasSlotDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç»„ä»¶å†…å¦‚æœæ²¡å†…å®¹ï¼Œ$slots.default ä¸º undefined</span>
    <span class="token keyword">return</span> <span class="token operator">!</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">.</span><span class="token keyword">default</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>æ¨¡æ¿å†™æ³•ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>project-main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>!hasSlotDefault<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>menu<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>menu<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-else</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="å¦‚ä½•åœ¨-eslintrc-js-ä¸­é…ç½®-prettier-è§„åˆ™"><a href="#å¦‚ä½•åœ¨-eslintrc-js-ä¸­é…ç½®-prettier-è§„åˆ™" aria-hidden="true" class="header-anchor">#</a> å¦‚ä½•åœ¨ .eslintrc.js ä¸­é…ç½® prettier è§„åˆ™</h3> <div class="language-js extra-class"><pre class="language-js"><code>rules<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token string">'prettier/prettier'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> singleQuote<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ä½¿ç”¨-emoji-è®¾ç½®-ç½‘é¡µçš„-favicon-çš„æ–¹æ³•"><a href="#ä½¿ç”¨-emoji-è®¾ç½®-ç½‘é¡µçš„-favicon-çš„æ–¹æ³•" aria-hidden="true" class="header-anchor">#</a> ä½¿ç”¨ emoji è®¾ç½® ç½‘é¡µçš„ favicon çš„æ–¹æ³•</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">setFavicon</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> favicon <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'link[rel=&quot;icon&quot;]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>favicon<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    favicon<span class="token punctuation">.</span>href <span class="token operator">=</span> url<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> link <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'link'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    link<span class="token punctuation">.</span>rel <span class="token operator">=</span> <span class="token string">'icon'</span><span class="token punctuation">;</span>
    link<span class="token punctuation">.</span>href <span class="token operator">=</span> url<span class="token punctuation">;</span>

    document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">emojiFavicon</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>emoji<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>
  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> context <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  context<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">'64px serif'</span><span class="token punctuation">;</span>
  context<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span>emoji<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> url <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">setFavicon</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Usage</span>
<span class="token function">emojiFavicon</span><span class="token punctuation">(</span><span class="token string">'ğŸ‰'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="è®¡ç®—-scrollbar-å®½åº¦çš„æ–¹æ³•"><a href="#è®¡ç®—-scrollbar-å®½åº¦çš„æ–¹æ³•" aria-hidden="true" class="header-anchor">#</a> è®¡ç®— scrollbar å®½åº¦çš„æ–¹æ³•</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">calculateScrollbarWidth</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> outer <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  outer<span class="token punctuation">.</span>style<span class="token punctuation">.</span>visibility <span class="token operator">=</span> <span class="token string">'hidden'</span><span class="token punctuation">;</span>
  outer<span class="token punctuation">.</span>style<span class="token punctuation">.</span>overflow <span class="token operator">=</span> <span class="token string">'scroll'</span><span class="token punctuation">;</span>

  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>outer<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> inner <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  outer<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>inner<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// é‡Œå¤–å®½åº¦ç›¸å‡å¾—å‡ºæ»šåŠ¨æ¡çš„å®½åº¦</span>
  <span class="token keyword">const</span> scrollbarWidth <span class="token operator">=</span> outer<span class="token punctuation">.</span>offsetWidth <span class="token operator">-</span> inner<span class="token punctuation">.</span>offsetWidth<span class="token punctuation">;</span>

  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>outer<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> scrollbarWidth<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="pipe-promise"><a href="#pipe-promise" aria-hidden="true" class="header-anchor">#</a> pipe-promise</h3> <p>è·Ÿ compose å‡½æ•°ç”¨æ³•ç±»ä¼¼ï¼Œåªä¸è¿‡ compose å‡½æ•°æ˜¯ä»å³åˆ°å·¦æ‰§è¡Œï¼Œé“¾å¼ï¼ŒæŒ‰é¡ºåºè°ƒç”¨ promise å‡½æ•°</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">pipe</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>functions<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  functions<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>chain<span class="token punctuation">,</span> func<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> chain<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">,</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="äº”æœˆ"><a href="#äº”æœˆ" aria-hidden="true" class="header-anchor">#</a> äº”æœˆ</h2> <h3 id="iview-modal-ç»„ä»¶-slot-é‡æ¸²æŸ“"><a href="#iview-modal-ç»„ä»¶-slot-é‡æ¸²æŸ“" aria-hidden="true" class="header-anchor">#</a> iview Modal ç»„ä»¶ slot é‡æ¸²æŸ“</h3> <p>iview Modal ç»„ä»¶å…³é—­åå†æ‰“å¼€å†…éƒ¨æ’æ§½ç»„ä»¶æ˜¯ä¸ä¼šé‡æ–°æ¸²æŸ“çš„ï¼Œå¦‚æœè¦é‡æ¸²æŸ“ï¼Œå¦‚ä½•å®ç°ï¼Ÿä¸‹é¢æ˜¯äºŒæ¬¡å°è£… Modal ç»„ä»¶è§£å†³æ–¹å¼çš„ä¸€äº›ä»£ç ç‰‡æ®µï¼š</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Modal</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>show<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>$attrs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-on</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>$listeners<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>slotRerender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>showSlot<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-else</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Modal</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  watch<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">async</span> <span class="token function">value</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>showSlot <span class="token operator">=</span> <span class="token operator">!</span>n<span class="token punctuation">;</span>
        <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>show <span class="token operator">=</span> n<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>showSlot <span class="token operator">=</span> n<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>show <span class="token operator">=</span> n<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="å¦‚ä½•ç”¨-this-xxx-æ–¹å¼æŒ‚è½½-vue-ç»„ä»¶"><a href="#å¦‚ä½•ç”¨-this-xxx-æ–¹å¼æŒ‚è½½-vue-ç»„ä»¶" aria-hidden="true" class="header-anchor">#</a> å¦‚ä½•ç”¨ this.\$xxx æ–¹å¼æŒ‚è½½ vue ç»„ä»¶</h3> <p>æ¯”å¦‚æˆ‘è¿™è¾¹æœ‰ä¸ªåŸºäº iview modal å°è£…çš„å¼¹çª—ç»„ä»¶ ErsConfirmï¼Œç”¨æ™®é€šçš„æ¨¡æ¿å†™æ³•å°±æ˜¯è¿™æ ·çš„</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ErsConfirm</span>
  <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>modal1<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>åˆ é™¤<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">confirm-info</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ç¡®å®šè¦åˆ é™¤è¯¥é¡¹ç›®å—ï¼Ÿ<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">@on-confirm</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ok<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">@on-close</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>cancel<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>å¦‚æœåœ¨ä¸šåŠ¡é€»è¾‘ä¸­å­˜åœ¨å¤šä¸ªè¯¢é—®å¼¹çª—å±‚ï¼Œå†™å¤§é‡æ¨¡æ¿æ˜¯æ¯”è¾ƒéš¾å—çš„äº‹æƒ…ï¼Œä»£ç ä¹Ÿæ¯”è¾ƒå†—ä½™ï¼Œæ‰€ä»¥éœ€è¦ç”¨ js å‘½ä»¤å¼çš„æ–¹å¼è¿›è¡Œç»„ä»¶æŒ‚è½½ï¼Œè¿™æ ·çœ‹èµ·æ¥å°±ä¼˜é›…å¾—å¤šï¼Œä¸‹é¢æ˜¯å®ç°è¿‡ç¨‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ErsConfirm <span class="token keyword">from</span> <span class="token string">'./ErsConfirm/ErsConfirm.vue'</span><span class="token punctuation">;</span>

<span class="token comment">// Vue.use()</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Vue<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$ErsConfirm <span class="token operator">=</span> createErsConfirm<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">createErsConfirm</span><span class="token punctuation">(</span>options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> instance <span class="token operator">=</span> ErsConfirm<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  instance<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// æ‹¿å±æ€§ï¼Œä¸æ‹¿æ–¹æ³•</span>
<span class="token keyword">function</span> <span class="token function">getAttrs</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>pre<span class="token punctuation">,</span> cur<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> props<span class="token punctuation">[</span>cur<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      pre<span class="token punctuation">[</span>cur<span class="token punctuation">]</span> <span class="token operator">=</span> props<span class="token punctuation">[</span>cur<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> pre<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">noop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

ErsConfirm<span class="token punctuation">.</span><span class="token function-variable function">newInstance</span> <span class="token operator">=</span> <span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> onConfirm<span class="token punctuation">,</span> onClose <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>
  <span class="token keyword">const</span> attrs <span class="token operator">=</span> <span class="token function">getAttrs</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    inheritAttrs<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      visible<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">change</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>$el <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>ErsConfirm
          value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>visible<span class="token punctuation">}</span>
          on<span class="token operator">-</span>input<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>change<span class="token punctuation">}</span>
          <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">{</span>
            attrs<span class="token punctuation">,</span>
            on<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              <span class="token string">'on-confirm'</span><span class="token punctuation">:</span> onConfirm <span class="token operator">||</span> noop<span class="token punctuation">,</span>
              <span class="token string">'on-close'</span><span class="token punctuation">:</span> onClose <span class="token operator">||</span> noop<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> component <span class="token operator">=</span> instance<span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>component<span class="token punctuation">.</span>$el<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      instance<span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>å®‰è£…æ’ä»¶</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> $ErsConfirm <span class="token keyword">from</span> <span class="token string">'./$ErsConfirm'</span><span class="token punctuation">;</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>$ErsConfirm<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>è¿™æ ·ï¼Œå°±å¯ä»¥ç”¨ this.\$ErsConfirm æ–¹å¼æ¥ä½¿ç”¨äº†è¯¥ç»„ä»¶äº†</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$ErsConfirm</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  title<span class="token punctuation">:</span> <span class="token string">'åˆ é™¤'</span><span class="token punctuation">,</span>
  confirmInfo<span class="token punctuation">:</span> <span class="token string">'ç¡®å®šè¦åˆ é™¤è¯¥é¡¹ç›®å—ï¼Ÿ'</span><span class="token punctuation">,</span>
  onConfirm<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'confirm'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  onClose<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="å…­æœˆ"><a href="#å…­æœˆ" aria-hidden="true" class="header-anchor">#</a> å…­æœˆ</h2> <h3 id="typescript-ä¸­çš„å…ƒç»„"><a href="#typescript-ä¸­çš„å…ƒç»„" aria-hidden="true" class="header-anchor">#</a> typeScript ä¸­çš„å…ƒç»„</h3> <p>å…ƒç»„å³ h ä¸ºåˆå¹¶äº†å¤šç§ç±»å‹çš„æ•°ç»„ï¼Œç”¨äºå®šä¹‰å…·æœ‰æœ‰é™æ•°é‡çš„æœªå‘½åå±æ€§çš„ç±»å‹</p> <p>æ¯”å¦‚è¿™ä¹ˆä½¿ç”¨ï¼š</p> <div class="language-typeScript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> tuple<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">boolean</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>é¢„å…ˆå£°æ˜äº†ä»€ä¹ˆç±»å‹ï¼Œéƒ½éœ€è¦æä¾›å¯¹åº”çš„å€¼</p> <h3 id="yarn-link-å‡ºç°-permission-denied"><a href="#yarn-link-å‡ºç°-permission-denied" aria-hidden="true" class="header-anchor">#</a> yarn link å‡ºç° permission denied</h3> <p>åœ¨æœ¬åœ°<code>mac</code>å¼€å‘ç¯å¢ƒä¸­ï¼Œ<code>yarn link</code>ä¹‹åå¦‚æœå¯èƒ½ä¼šé‡åˆ°<code>permission denied</code>é—®é¢˜ï¼Œå¯å‚è€ƒè¿™ä¸ª<a href="https://github.com/yarnpkg/yarn/issues/3587" target="_blank" rel="noopener noreferrer">issue<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>è§£å†³æ–¹æ³•å°±æ˜¯éœ€è¦ä½¿ç”¨<code>chmod +x</code>+ä½ çš„<code>bin</code>æ–‡ä»¶ä¸­çš„<code>index.js</code>å¼€å¯å¯æ‰§è¡Œæƒé™ï¼Œä¾‹å¦‚ä½ çš„æ–‡ä»¶åœ¨<code>xxx/cli/bin/index.js</code>ä¸­ï¼Œåˆ™ä½¿ç”¨<code>chmod +x xxx/cli/bin/index.js</code>å°±å¯ä»¥äº†</p> <h3 id="object-is-polyfill"><a href="#object-is-polyfill" aria-hidden="true" class="header-anchor">#</a> Object.is polyfill</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Object<span class="token punctuation">.</span>is<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Object<span class="token punctuation">.</span><span class="token function-variable function">is</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// SameValue algorithm</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">===</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Steps 1-5, 7-10</span>
      <span class="token comment">// Steps 6.b-6.e: +0 != -0</span>
      <span class="token keyword">return</span> x <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token number">1</span> <span class="token operator">/</span> x <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">/</span> y<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// Step 6.a: NaN == NaN</span>
      <span class="token keyword">return</span> x <span class="token operator">!==</span> x <span class="token operator">&amp;&amp;</span> y <span class="token operator">!==</span> y<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="yarn-link-ä¹‹åå¯æ‰§è¡Œå‘½ä»¤å­˜åœ¨å“ªé‡Œ"><a href="#yarn-link-ä¹‹åå¯æ‰§è¡Œå‘½ä»¤å­˜åœ¨å“ªé‡Œ" aria-hidden="true" class="header-anchor">#</a> yarn link ä¹‹åå¯æ‰§è¡Œå‘½ä»¤å­˜åœ¨å“ªé‡Œ</h3> <p>å­˜åœ¨äº†<code>/usr/local/bin</code>ç›®å½•ä¸‹</p> <h2 id="ä¸ƒæœˆ"><a href="#ä¸ƒæœˆ" aria-hidden="true" class="header-anchor">#</a> ä¸ƒæœˆ</h2> <h3 id="è½¬è¯‘å‡½æ•°"><a href="#è½¬è¯‘å‡½æ•°" aria-hidden="true" class="header-anchor">#</a> è½¬è¯‘å‡½æ•°</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Security helper :)</span>
<span class="token keyword">function</span> <span class="token function">EscapeHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'&amp;'</span><span class="token punctuation">:</span> <span class="token string">'&amp;amp;'</span><span class="token punctuation">,</span>
    <span class="token string">'&lt;'</span><span class="token punctuation">:</span> <span class="token string">'&amp;lt;'</span><span class="token punctuation">,</span>
    <span class="token string">'&gt;'</span><span class="token punctuation">:</span> <span class="token string">'&amp;gt;'</span><span class="token punctuation">,</span>
    <span class="token string">'&quot;'</span><span class="token punctuation">:</span> <span class="token string">'&amp;quot;'</span><span class="token punctuation">,</span>
    <span class="token string">&quot;'&quot;</span><span class="token punctuation">:</span> <span class="token string">'&amp;#039;'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> text<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[&amp;&lt;&gt;&quot;']/g</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> map<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="nodejs-ä¸€äº›è·¯å¾„å˜é‡"><a href="#nodejs-ä¸€äº›è·¯å¾„å˜é‡" aria-hidden="true" class="header-anchor">#</a> nodejs ä¸€äº›è·¯å¾„å˜é‡</h3> <p>æœ€è¿‘åœ¨å†™è„šæ‰‹æ¶ï¼Œè®°å½•äº›è·¯å¾„å˜é‡</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å½“å‰æ–‡ä»¶æ‰§è¡Œè·¯å¾„</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å½“å‰ç¨‹åºè¿è¡Œè·¯å¾„ï¼Œä¹Ÿå°±æ˜¯åœ¨å“ªå¼€å§‹ node xxx çš„</span>

<span class="token comment">// path.resolve() æ–¹æ³•å¯ä»¥å°†å¤šä¸ªè·¯å¾„è§£æä¸ºä¸€ä¸ªè§„èŒƒåŒ–çš„ç»å¯¹è·¯å¾„</span>
<span class="token comment">// path.join() æ–¹æ³•å¯ä»¥è¿æ¥ä»»æ„å¤šä¸ªè·¯å¾„å­—ç¬¦ä¸²</span>
<span class="token comment">// æ³¨æ„ï¼Œpathè¿™äº›apiå¹¶ä¸ä¼šä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿæ¥åˆ¤æ–­è¯¥è·¯å¾„åˆä¸åˆæ³•ï¼Œåªæ˜¯å•çº¯çš„å¤„ç†'./'å’Œ'/'</span>
</code></pre></div><h3 id="æ¨¡å—é‡å®šå‘"><a href="#æ¨¡å—é‡å®šå‘" aria-hidden="true" class="header-anchor">#</a> æ¨¡å—é‡å®šå‘</h3> <p>å¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨å½“å‰æ¨¡å—ä¸­ï¼Œå¯¼å‡ºæŒ‡å®šå¯¼å…¥æ¨¡å—çš„é»˜è®¤å¯¼å‡ºï¼ˆç­‰äºæ˜¯åˆ›å»ºäº†ä¸€ä¸ªâ€œé‡å®šå‘â€ï¼‰ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token constant">A</span> <span class="token keyword">from</span> &quot;<span class="token punctuation">.</span><span class="token operator">/</span><span class="token constant">A</span><span class="token punctuation">.</span>vue'<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token constant">A</span><span class="token punctuation">;</span>

<span class="token comment">// å…¶å®æ˜¯å¯ä»¥ç”¨æ¨¡å—é‡å®šå‘ç®€å†™çš„</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./A.vue&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// å¦‚æœæ¨¡å—æœ‰å¤šä¸ªå¯¼å‡ºï¼Œå¯ä»¥è¿™ä¹ˆåš</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./other-module'</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="ts-ä½¿ç”¨-fs-promises"><a href="#ts-ä½¿ç”¨-fs-promises" aria-hidden="true" class="header-anchor">#</a> ts ä½¿ç”¨ fs.promises</h3> <p>ä½¿ç”¨ node è‡ªå¸¦<code>fs.promises</code>æ¨¡å—ï¼Œå¯ä»¥ä¸éœ€è¦<code>fs-extra</code>äº†</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> promises <span class="token keyword">as</span> fs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'fs'</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="æŸ¥çœ‹è¿œç¨‹-npm-åŒ…æœ€æ–°ç‰ˆæœ¬"><a href="#æŸ¥çœ‹è¿œç¨‹-npm-åŒ…æœ€æ–°ç‰ˆæœ¬" aria-hidden="true" class="header-anchor">#</a> æŸ¥çœ‹è¿œç¨‹ npm åŒ…æœ€æ–°ç‰ˆæœ¬</h3> <p>æœ€è¿‘è„šæ‰‹æ¶åšäº†ä¸ªæ£€æµ‹æ›´æ–°çš„åŠŸèƒ½ï¼Œéœ€è¦æ£€æµ‹è¿œç¨‹ npm åŒ…çš„ç‰ˆæœ¬ï¼Œå’Œæœ¬åœ°è¿›è¡Œå¯¹æ¯”ï¼Œè·å¾— npm åŒ…æœ€æ–°ç‰ˆæœ¬æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š</p> <p>ç¬¬ä¸€ç§ï¼Œç›´æ¥ç”¨ npm è‡ªå¸¦è„šæœ¬</p> <div class="language- extra-class"><pre class="language-text"><code>npm show xxx version
</code></pre></div><p>ç¬¬äºŒç§ï¼Œä½¿ç”¨ç¬¬ä¸‰æ–¹åº“<a href="https://github.com/sindresorhus/latest-version#readme" target="_blank" rel="noopener noreferrer">latest-version<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>è¿›è¡Œæ£€æµ‹</p> <h3 id="docker-nginx-å®¹å™¨-hjson-ä¸­æ–‡ä¹±ç "><a href="#docker-nginx-å®¹å™¨-hjson-ä¸­æ–‡ä¹±ç " aria-hidden="true" class="header-anchor">#</a> docker nginx å®¹å™¨ hjson ä¸­æ–‡ä¹±ç </h3> <p>linux ä¸‹é‡‡ç”¨ utf-8 ç¼–ç ï¼Œé»˜è®¤æƒ…å†µä¸‹æˆ‘ä»¬çš„æµè§ˆå™¨åœ¨æœåŠ¡å™¨æ²¡æœ‰æŒ‡å®šç¼–ç æˆ–è€…é™æ€é¡µé¢æ²¡æœ‰å£°æ˜ç¼–ç çš„æƒ…å†µä¸‹ä¼šä»¥ gbk çš„ç¼–ç å»æ¸²æŸ“é¡µé¢ï¼Œè¿™æ ·é»˜è®¤æƒ…å†µä¸‹è¿”å›ä¸­æ–‡çš„è¯æµè§ˆå™¨ç”¨ gbk æ¥è§£æ utf-8 ç¼–ç ï¼Œä¼šå‡ºç°ä¹±ç ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p> <p>åœ¨ server é…ç½®ä¸­å¢åŠ </p> <div class="language- extra-class"><pre class="language-text"><code>server {
  add_header Content-Type 'text/html; charset=utf-8';
}
</code></pre></div><p>è¿™ç§ä¸»è¦æ˜¯è§£å†³ network ä¸­ previvew ä¸­ä¹±ç ï¼Œåœ¨é¡µé¢ä¸Šæ˜¾ç¤ºè¿˜æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºé¡µé¢æœ¬æ¥å°±æŒ‡å®šäº† utf-8 ç¼–ç </p> <h3 id="è·å–é¡¹ç›®éƒ¨ç½²è·¯å¾„"><a href="#è·å–é¡¹ç›®éƒ¨ç½²è·¯å¾„" aria-hidden="true" class="header-anchor">#</a> è·å–é¡¹ç›®éƒ¨ç½²è·¯å¾„</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// é»˜è®¤è·å–ç¬¬ä¸€å±‚</span>
<span class="token comment">// çœ‹&quot;/&quot;åœ¨å“ªï¼Œå–åˆ°å“ªï¼Œä»0å¼€å§‹æ•°èµ·</span>
<span class="token keyword">const</span> <span class="token function-variable function">getAbsolutePath</span> <span class="token operator">=</span> <span class="token punctuation">(</span>level <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> path <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">;</span>

  <span class="token keyword">let</span> numDirsProcessed <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>path<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> path<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>level <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'/'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>numDirsProcessed <span class="token operator">!==</span> level<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> char <span class="token operator">=</span> path<span class="token punctuation">[</span><span class="token operator">++</span>start<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>char <span class="token operator">===</span> <span class="token string">'/'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      numDirsProcessed<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>char<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">'/'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> start <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">getDeployPath</span> <span class="token operator">=</span> <span class="token punctuation">(</span>level<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>origin <span class="token operator">+</span> <span class="token function">getAbsolutePath</span><span class="token punctuation">(</span>level<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="nodejs-åˆ¤æ–­æ–‡ä»¶æˆ–è€…ç›®å½•æ˜¯å¦å­˜åœ¨çš„"><a href="#nodejs-åˆ¤æ–­æ–‡ä»¶æˆ–è€…ç›®å½•æ˜¯å¦å­˜åœ¨çš„" aria-hidden="true" class="header-anchor">#</a> nodejs åˆ¤æ–­æ–‡ä»¶æˆ–è€…ç›®å½•æ˜¯å¦å­˜åœ¨çš„</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//</span>
<span class="token keyword">function</span> <span class="token function">pathExists</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> fs<span class="token punctuation">.</span>promises
    <span class="token punctuation">.</span><span class="token function">access</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="nodejs-é›†ä½“å¯¼å‡ºæ¨¡å—çš„æ–¹æ³•"><a href="#nodejs-é›†ä½“å¯¼å‡ºæ¨¡å—çš„æ–¹æ³•" aria-hidden="true" class="header-anchor">#</a> nodejs é›†ä½“å¯¼å‡ºæ¨¡å—çš„æ–¹æ³•</h3> <p>åˆå¹¶åˆ°<code>exports</code>å¯¹è±¡ä¸Šå³å¯ï¼Œå‚è€ƒäº†<code>@vue/cli-shared-utils</code>æºç </p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span>
  <span class="token string">'env'</span><span class="token punctuation">,</span>
  <span class="token string">'exit'</span><span class="token punctuation">,</span>
  <span class="token string">'ipc'</span><span class="token punctuation">,</span>
  <span class="token string">'logger'</span><span class="token punctuation">,</span>
  <span class="token string">'module'</span><span class="token punctuation">,</span>
  <span class="token string">'object'</span><span class="token punctuation">,</span>
  <span class="token string">'openBrowser'</span><span class="token punctuation">,</span>
  <span class="token string">'pkg'</span><span class="token punctuation">,</span>
  <span class="token string">'pluginResolution'</span><span class="token punctuation">,</span>
  <span class="token string">'launch'</span><span class="token punctuation">,</span>
  <span class="token string">'request'</span><span class="token punctuation">,</span>
  <span class="token string">'spinner'</span><span class="token punctuation">,</span>
  <span class="token string">'validate'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`./lib/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>m<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="å…«æœˆ"><a href="#å…«æœˆ" aria-hidden="true" class="header-anchor">#</a> å…«æœˆ</h2> <h3 id="docker-å¦‚ä½•ä¸ä½¿ç”¨ç¼“å­˜é‡å»ºé•œåƒ"><a href="#docker-å¦‚ä½•ä¸ä½¿ç”¨ç¼“å­˜é‡å»ºé•œåƒ" aria-hidden="true" class="header-anchor">#</a> docker å¦‚ä½•ä¸ä½¿ç”¨ç¼“å­˜é‡å»ºé•œåƒ</h3> <p>docker åœ¨é‡å»ºé•œåƒçš„æ—¶å€™ï¼Œä¼šä¼˜å…ˆä½¿ç”¨ç¼“å­˜è¿›è¡Œæ„å»ºï¼Œä½†æ˜¯æœ‰äº›æƒ…å†µä¸èƒ½ä½¿ç”¨ç¼“å­˜æ„å»ºï¼Œæ¯”å¦‚å‰ç«¯ä»£ç æ‹‰å–æ‰“åŒ…è¿™äº›ï¼Œå¦‚ä½•ç”¨äº†ç¼“å­˜ç”Ÿæˆä»£ç å°±ä¸èƒ½æ›´æ–°ï¼Œæ‰€ä»¥éœ€è¦è§£å†³è¿™ä¸ªé—®é¢˜</p> <p><code>docker build --no-cache .</code></p> <p>æ„å»ºæ—¶å¸¦ä¸Š<code>--no-cache</code>å³å¯</p> <h3 id="åˆ¤æ–­ç©ºå¯¹è±¡çš„æ–¹æ³•"><a href="#åˆ¤æ–­ç©ºå¯¹è±¡çš„æ–¹æ³•" aria-hidden="true" class="header-anchor">#</a> åˆ¤æ–­ç©ºå¯¹è±¡çš„æ–¹æ³•</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">checkObjectEmpty</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    value <span class="token operator">&amp;&amp;</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> value<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Object
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸ºä»€ä¹ˆè¦åŠ <code>value.constructor === Object</code>çš„åˆ¤æ–­ï¼Ÿ</p> <p>å¦‚æœä¸åŠ ï¼Œå‚æ•°è¾“å…¥ä»¥ä¸‹è¿™å‡ ç§å‡ä¸º<code>true</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">checkObjectEmpty</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token function">checkObjectEmpty</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token function">checkObjectEmpty</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Boolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token function">checkObjectEmpty</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token function">checkObjectEmpty</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token function">checkObjectEmpty</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token function">checkObjectEmpty</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>å®é™…ä¸Šï¼Œæˆ‘ä»¬åªæ£€æµ‹<code>new Object()</code>è€Œä¸åŒ…æ‹¬ä¸Šé¢è¿™ç§æ„é€ å‡½æ•°çš„å®ä¾‹</p> <p>è¿˜æœ‰ï¼Œå¢åŠ  value æ˜¯å¦å­˜åœ¨çš„åˆ¤æ–­ï¼Œæ˜¯ä¸ºäº†è¿‡æ»¤<code>null</code>å’Œ<code>undefined</code>ï¼Œé¿å…æŠ¥ error</p> <h3 id="es6-åˆ¤æ–­-2-ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰"><a href="#es6-åˆ¤æ–­-2-ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰" aria-hidden="true" class="header-anchor">#</a> ES6 åˆ¤æ–­ 2 ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> o1 <span class="token operator">=</span> <span class="token punctuation">{</span> fruit<span class="token punctuation">:</span> <span class="token string">'apple'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> o2 <span class="token operator">=</span> <span class="token punctuation">{</span> fruit<span class="token punctuation">:</span> <span class="token string">'apple'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>o1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>o2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><h3 id="è¿‡æ»¤å¯¹è±¡æŸä¸ª-key-å€¼"><a href="#è¿‡æ»¤å¯¹è±¡æŸä¸ª-key-å€¼" aria-hidden="true" class="header-anchor">#</a> è¿‡æ»¤å¯¹è±¡æŸä¸ª key å€¼</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> food <span class="token operator">=</span> <span class="token punctuation">{</span> meat<span class="token punctuation">:</span> <span class="token string">'ğŸ¥©'</span><span class="token punctuation">,</span> broccoli<span class="token punctuation">:</span> <span class="token string">'ğŸ¥¦'</span><span class="token punctuation">,</span> carrot<span class="token punctuation">:</span> <span class="token string">'ğŸ¥•'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">filterObjectKey</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">fromEntries</span><span class="token punctuation">(</span>
    Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> key <span class="token operator">!==</span> k<span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">filterObjectKey</span><span class="token punctuation">(</span>food<span class="token punctuation">,</span> <span class="token string">'meat'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { broccoli: 'ğŸ¥¦', carrot: 'ğŸ¥•' }</span>
</code></pre></div><h3 id="babel-æ˜¯æ€ä¹ˆå®ç°-const-å’Œ-let-å—çº§ä½œç”¨åŸŸçš„"><a href="#babel-æ˜¯æ€ä¹ˆå®ç°-const-å’Œ-let-å—çº§ä½œç”¨åŸŸçš„" aria-hidden="true" class="header-anchor">#</a> babel æ˜¯æ€ä¹ˆå®ç° const å’Œ let å—çº§ä½œç”¨åŸŸçš„</h3> <p>åœ¨ ES6 ä¸­ï¼Œconst å’Œ let å£°æ˜å˜é‡åªä¼šåœ¨ä»£ç å—ä¸­æœ‰æ•ˆï¼Œä½†æ˜¯åœ¨ ES5 ä¸­æ˜¯æ²¡æœ‰çš„ï¼Œé‚£ babel æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ</p> <p>å…¶å® babel æ˜¯é€šè¿‡ç¼–è¯‘æ—¶å®ç°çš„ï¼Œè€Œéè¿è¡Œæ—¶å®ç°ï¼Œæ¯”å¦‚ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> content <span class="token operator">=</span> <span class="token template-string"><span class="token string">``</span></span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ç¼–è¯‘åï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> _content <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_content<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œå—çº§å†…çš„<code>content</code>å˜é‡è¢«ç¼–è¯‘æˆ<code>_content</code>ï¼Œå—çº§å¤–é¢çš„<code>content</code>åˆ™æ²¡è¢«ç¼–è¯‘ï¼Œè¿™æ ·å°±å®ç°äº†å—çº§ä½œç”¨åŸŸåŒ–</p> <p>é‚£è€ç”Ÿå¸¸è°ˆçš„ for å¾ªç¯ä¸­çš„ let å—çº§ä½œç”¨åŸŸçš„å®ç°å‘¢ï¼Œå› ä¸ºå•çº¯é æ”¹å˜å˜é‡åæ˜¯å®ç°ä¸äº†çš„ï¼Œæ¯”å¦‚<code>for (var i = 0; i &lt; 10; i++)</code>å’Œ<code>for (var _i = 0; _i &lt; 10; _i++)</code>æ˜¯ä¸€æ ·çš„ï¼Œbabel çš„å®ç°æ˜¯è¿™æ ·çš„ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç¼–è¯‘åï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token function-variable function">_loop</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">_loop</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">_loop</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œbabel çš„å®ç°æ–¹å¼æ˜¯å¢åŠ ä¸€ä¸ª<code>_loop</code>å‡½æ•°ï¼Œæ¯æ¬¡å¾ªç¯éƒ½æ‰§è¡Œä¸€æ¬¡<code>_loop</code>å‡½æ•°ï¼ŒæŠŠå˜é‡ä¿å­˜åœ¨<strong>é—­åŒ…</strong>é‡Œé¢ï¼Œè¿™æ ·è¯»å–çš„å°±ä¸æ˜¯å…¨å±€å˜é‡ i äº†</p> <h3 id="ts-get-å‡½æ•°æ­£ç¡®å†™æ³•"><a href="#ts-get-å‡½æ•°æ­£ç¡®å†™æ³•" aria-hidden="true" class="header-anchor">#</a> ts get å‡½æ•°æ­£ç¡®å†™æ³•</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'obj'</span><span class="token punctuation">,</span>
  value<span class="token punctuation">:</span> <span class="token number">666</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token keyword">get</span><span class="token punctuation">(</span>obj<span class="token punctuation">:</span> object<span class="token punctuation">,</span> key<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™ç§å†™æ³•æ˜¯æœ‰é—®é¢˜çš„ï¼Œts æ— æ³•æ¨æ–­è¿”å›å€¼çš„ç±»å‹ï¼Œä¹Ÿæ— æ³•å¯¹ key å€¼è¿›è¡Œçº¦æŸ</p> <p>æ­£ç¡®çš„å†™æ³•ï¼Œå…³é”®åœ¨äº<code>keyof</code>çš„ä½¿ç”¨</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token keyword">get</span><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">object</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token class-name">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>obj<span class="token punctuation">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> key<span class="token punctuation">:</span> <span class="token constant">K</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="nodejs-æ‹‰å–è¿œç«¯å›¾ç‰‡ä¿å­˜æœ¬åœ°åŸºç¡€å†™æ³•"><a href="#nodejs-æ‹‰å–è¿œç«¯å›¾ç‰‡ä¿å­˜æœ¬åœ°åŸºç¡€å†™æ³•" aria-hidden="true" class="header-anchor">#</a> nodejs æ‹‰å–è¿œç«¯å›¾ç‰‡ä¿å­˜æœ¬åœ°åŸºç¡€å†™æ³•</h3> <p><code>http</code>æ¨¡å—è¯·æ±‚æ–¹å¼</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fetchFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  http<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`xxx.jpg`</span></span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>stream<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> chunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    stream<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      chunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    stream<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      res <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>chunks<span class="token punctuation">)</span><span class="token punctuation">;</span>

      fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'xxx.jpg'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>axios</code>è¯·æ±‚æ–¹å¼</p> <div class="language-js extra-class"><pre class="language-js"><code>axios
  <span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`xxx.jpg`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ³¨é‡è¦æŒ‡å®š responseType ä¸º &quot;arraybuffer&quot;</span>
    <span class="token comment">// ä¸ç„¶é»˜è®¤è¿”å›çš„æ˜¯Buffer.toString()</span>
    <span class="token comment">// è¿™æ ·ä¿å­˜å›¾ç‰‡å°±ä¼šæœ‰é—®é¢˜</span>
    responseType<span class="token punctuation">:</span> <span class="token string">'arraybuffer'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span><span class="token string">'xxx.jpg'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>axios</code>æºç å†™æ³•å¦‚ä¸‹</p> <div class="language-js extra-class"><pre class="language-js"><code>stream<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">handleStreamEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> responseData <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>responseBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>responseType <span class="token operator">!==</span> <span class="token string">'arraybuffer'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    responseData <span class="token operator">=</span> responseData<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>responseEncoding<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  response<span class="token punctuation">.</span>data <span class="token operator">=</span> responseData<span class="token punctuation">;</span>
  <span class="token function">settle</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æ‰€ä»¥ä½¿ç”¨<code>axios</code>è¯·æ±‚å›¾ç‰‡æµæ—¶éœ€è¦å£°æ˜<code>responseType</code>ä¸º<code>&quot;arraybuffer&quot;</code></p> <h2 id="ä¹æœˆ"><a href="#ä¹æœˆ" aria-hidden="true" class="header-anchor">#</a> ä¹æœˆ</h2> <h3 id="æµè§ˆå™¨å¦‚ä½•æ£€æµ‹ç³»ç»Ÿä¸»é¢˜è‰²"><a href="#æµè§ˆå™¨å¦‚ä½•æ£€æµ‹ç³»ç»Ÿä¸»é¢˜è‰²" aria-hidden="true" class="header-anchor">#</a> æµè§ˆå™¨å¦‚ä½•æ£€æµ‹ç³»ç»Ÿä¸»é¢˜è‰²</h3> <p>åœ¨è¾ƒæ–°çš„æµè§ˆå™¨ä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>prefers-color-scheme</code>CSS åª’ä½“æŸ¥è¯¢æ¥æ£€æµ‹ç³»ç»Ÿä¸»é¢˜è‰²ä¸º<code>light</code>æˆ–è€…æ˜¯<code>dark</code></p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">prefers-color-scheme</span><span class="token punctuation">:</span> dark<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector">.day.dark-scheme</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.night.dark-scheme</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #ddd<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">prefers-color-scheme</span><span class="token punctuation">:</span> light<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector">.day.light-scheme</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #555<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.night.light-scheme</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #eee<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>é‚£åœ¨<code>js</code>ä¸­å¦‚ä½•æ£€æµ‹å‘¢ï¼Ÿè¿˜æ˜¯æœ‰æ–¹æ³•çš„ï¼Œä½¿ç”¨<code>window.matchMedia</code>æ¥æ£€æµ‹</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> darkMode <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">matchMedia</span><span class="token punctuation">(</span><span class="token string">'(prefers-color-scheme: dark)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> lightMode <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">matchMedia</span><span class="token punctuation">(</span><span class="token string">'(prefers-color-scheme: light)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>darkMode<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>lightMode<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="å‰ç«¯å¦‚ä½•ä¸‹è½½-base64-å­—ç¬¦ä¸²å›¾ç‰‡"><a href="#å‰ç«¯å¦‚ä½•ä¸‹è½½-base64-å­—ç¬¦ä¸²å›¾ç‰‡" aria-hidden="true" class="header-anchor">#</a> å‰ç«¯å¦‚ä½•ä¸‹è½½ base64 å­—ç¬¦ä¸²å›¾ç‰‡</h3> <p>å‰ç«¯æƒ³ä¸‹è½½å›¾ç‰‡ï¼Œå¦‚æœåç«¯è¿”å›äº†<code>base64</code>å­—ç¬¦ï¼Œæ²¡æœ‰è¿”å›æ–‡ä»¶æµçš„è¯ï¼Œæ”¹å¦‚ä½•å®ç°ä¸‹è½½ï¼Ÿ</p> <p>é¦–å…ˆè¦æŠŠ base64 å­—ç¬¦ä¸²è½¬ blob</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">base64ToBlob</span><span class="token punctuation">(</span>base64<span class="token punctuation">,</span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> byteCharacters <span class="token operator">=</span> <span class="token function">atob</span><span class="token punctuation">(</span>base64<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è§£ç </span>
  <span class="token keyword">const</span> byteNumbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>byteCharacters<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> byteCharacters<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    byteNumbers<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> byteCharacters<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> buffer <span class="token operator">=</span> Uint8Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span>byteNumbers<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>buffer<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> blob<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç„¶åå†æŠŠ<code>blob</code>è½¬æˆ<code>blob:URL</code>, a æ ‡ç­¾ä¸‹è½½<code>blob:URL</code>å³å¯</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">downloadBlob</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> aTag <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  aTag<span class="token punctuation">.</span>download <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> blobUrl <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
  aTag<span class="token punctuation">.</span>href <span class="token operator">=</span> blobUrl<span class="token punctuation">;</span>
  aTag<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>blobUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ç”ŸæˆåŒºé—´çš„éšæœºæ•°"><a href="#ç”ŸæˆåŒºé—´çš„éšæœºæ•°" aria-hidden="true" class="header-anchor">#</a> ç”ŸæˆåŒºé—´çš„éšæœºæ•°</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getRandomIntInclusive</span><span class="token punctuation">(</span>min<span class="token punctuation">,</span> max<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  min <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>min<span class="token punctuation">)</span><span class="token punctuation">;</span>
  max <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>max <span class="token operator">-</span> min <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> min<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="chrome-å¼€å¯-pause-on-exceptions"><a href="#chrome-å¼€å¯-pause-on-exceptions" aria-hidden="true" class="header-anchor">#</a> chrome å¼€å¯ pause on exceptions</h3> <p>åœ¨<code>sources</code>é¢æ¿ä¸­å¯ä»¥å¼€å¯<code>pause on exceptions</code>åŠŸèƒ½ï¼Œè¿™ä¸ªåŠŸèƒ½å¯ä»¥åœ¨ä»£ç å‡ºç°å¼‚å¸¸çš„è‡ªåŠ¨æ‰“ä¸Šæ–­ç‚¹ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„æ’æŸ¥æœªæ•è·é”™è¯¯å‘ç”Ÿçš„ä½ç½®ã€‚</p> <h2 id="åæœˆ"><a href="#åæœˆ" aria-hidden="true" class="header-anchor">#</a> åæœˆ</h2> <h3 id="æŸ¥çœ‹é¡¹ç›®-node-modules-æ–‡ä»¶å¤¹å¤§å°"><a href="#æŸ¥çœ‹é¡¹ç›®-node-modules-æ–‡ä»¶å¤¹å¤§å°" aria-hidden="true" class="header-anchor">#</a> æŸ¥çœ‹é¡¹ç›® node_modules æ–‡ä»¶å¤¹å¤§å°</h3> <p>unix å’Œ linux ç³»ç»Ÿä½¿ç”¨<code>du -hd 0 node_modules</code>å³å¯</p> <p><code>du -hd 1 node_modules</code>å¯ä»¥æŸ¥çœ‹é‡Œé¢æ¯ä¸ªæ–‡ä»¶å¤¹çš„æ–‡ä»¶å¤§å°</p> <h3 id="vue-devtool-æ— æ³•æ˜¾ç¤ºä½¿ç”¨-mount-åŠ¨æ€æŒ‚è½½çš„ç»„ä»¶è§£å†³æ–¹æ³•"><a href="#vue-devtool-æ— æ³•æ˜¾ç¤ºä½¿ç”¨-mount-åŠ¨æ€æŒ‚è½½çš„ç»„ä»¶è§£å†³æ–¹æ³•" aria-hidden="true" class="header-anchor">#</a> vue-devtool æ— æ³•æ˜¾ç¤ºä½¿ç”¨ <code>$mount</code> åŠ¨æ€æŒ‚è½½çš„ç»„ä»¶è§£å†³æ–¹æ³•</h3> <p>ç±»ä¼¼è¿™ç§æƒ…å†µ</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>component<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
  <span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> MyComponent <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'component'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">new</span> <span class="token class-name">MyComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#component'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åŠ¨æ€æŒ‚è½½ç»„ä»¶</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ° id ä¸º<code>component</code>çš„ç»„ä»¶æ˜¯åŠ¨æ€æŒ‚è½½ä¸Šå»çš„ï¼Œè¿™ç§æƒ…å†µåœ¨<strong>vue-devtool</strong>ä¸­æ— æ³•æ˜¾ç¤ºè¿™ä¸ªå­ç»„ä»¶ï¼Œåªä¼šæ˜¾ç¤º<code>root</code>ç»„ä»¶ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿä¸»è¦æ˜¯åŠ¨æ€æŒ‚è½½çš„ç»„ä»¶å’Œ root ç»„ä»¶æ²¡æœ‰å½¢æˆçˆ¶å­å…³ç³»ï¼Œå› ä¸º vue å·²ç»åˆå§‹åŒ–å®Œæˆï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨å£°æ˜ä¸‹ä»–ä»¬çš„çˆ¶å­å…³ç³»ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> MyComponent <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'component'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">MyComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  parent<span class="token punctuation">:</span> root<span class="token punctuation">,</span> <span class="token comment">// å£°æ˜çˆ¶å­å…³ç³»</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#component'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æˆ–è€…ç”¨è¿™ç§æ–¹æ³•ä¹Ÿè¡Œ</span>
MyComponent<span class="token punctuation">.</span>$parent <span class="token operator">=</span> root<span class="token punctuation">;</span>
root<span class="token punctuation">.</span>$children<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>MyComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="æœ¬åœ°å›¾ç‰‡é¢„è§ˆ"><a href="#æœ¬åœ°å›¾ç‰‡é¢„è§ˆ" aria-hidden="true" class="header-anchor">#</a> æœ¬åœ°å›¾ç‰‡é¢„è§ˆ</h3> <p>æœ¬åœ°å›¾ç‰‡é¢„è§ˆï¼Œåœ¨ type ä¸º file çš„ input æ ‡ç­¾ä¸Šä¼ è§¦å‘ onchange äº‹ä»¶å‘ç”Ÿåï¼Œä½¿ç”¨ FileReader å³å¯å®ç°</p> <p>ä¸€ç§æ˜¯ä½¿ç”¨<code>data:URL</code>base64 å±•ç¤ºï¼Œä¸è¿‡è¿™ç§é•¿åº¦æµè§ˆå™¨æœ‰é™åˆ¶</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> output <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#preview'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  output<span class="token punctuation">.</span>src <span class="token operator">=</span> reader<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
reader<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å¦ä¸€ç§æ˜¯ä½¿ç”¨<code>blob:URL</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> output <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#preview'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>reader<span class="token punctuation">.</span>result<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'image/png'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> blobUrl <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
  output<span class="token punctuation">.</span>src <span class="token operator">=</span> blobUrl<span class="token punctuation">;</span>
  <span class="token function">queueMicrotask</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>blobUrl<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¼‚æ­¥ revoke</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
reader<span class="token punctuation">.</span><span class="token function">readAsArrayBuffer</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="nginx-å¼€å¯è´Ÿè½½å‡è¡¡"><a href="#nginx-å¼€å¯è´Ÿè½½å‡è¡¡" aria-hidden="true" class="header-anchor">#</a> nginx å¼€å¯è´Ÿè½½å‡è¡¡</h3> <p>ä½¿ç”¨<code>proxy_pass</code>å’Œ<code>upstream</code>å¯ä»¥å¼€å¯è´Ÿè½½å‡è¡¡</p> <div class="language- extra-class"><pre class="language-text"><code>http {
  upstream site {
    server 192.168.0.1;
    server 192.168.0.2;
    server 192.168.0.3;
  }

  server {
    listen 80;
    location / {
      proxy_pass http://site;
    }
  }
}
</code></pre></div><p>è´Ÿè½½å‡è¡¡æœ‰ 4 ç§æ¨¡å¼</p> <ul><li>è½®è¯¢</li></ul> <p>é»˜è®¤ä½¿ç”¨çš„æ–¹å¼ï¼ŒæŒ‰æœåŠ¡å™¨é…ç½®èŠ‚ç‚¹é¡ºåºè½®è¯¢</p> <ul><li>åŠ æƒè½®è¯¢</li></ul> <div class="language- extra-class"><pre class="language-text"><code>upstream site {
  server 192.168.0.1 weight=1;
  server 192.168.0.2 weight=2;
  server 192.168.0.3 weight=3;
}
</code></pre></div><ul><li>ip_hash</li></ul> <p>å¯¹ ip åœ°å€è¿›è¡Œ hashï¼Œè¿™æ ·ç”¨æˆ·å°±ä¼šåœ¨å›ºå®šçš„æœåŠ¡å™¨ä¸Šè¯·æ±‚ï¼Œåˆ©äºç¼“å­˜å’Œè¿›è¡Œæ¥å£æµ‹è¯•</p> <div class="language- extra-class"><pre class="language-text"><code>upstream site {
  server 192.168.0.1;
  server 192.168.0.2;
  server 192.168.0.3;
  ip_hash;
}
</code></pre></div><ul><li>least_conn;</li></ul> <p>ä¼˜å…ˆé€‰æ‹©è¿æ¥æ•°é‡æœ€å°‘çš„æœåŠ¡å™¨è´Ÿè½½</p> <div class="language- extra-class"><pre class="language-text"><code>upstream site {
  server 192.168.0.1;
  server 192.168.0.2;
  server 192.168.0.3;
  least_conn;
}
</code></pre></div><h3 id="ä¸€è¡Œä»£ç å®ç°è¯„åˆ†ç»„ä»¶"><a href="#ä¸€è¡Œä»£ç å®ç°è¯„åˆ†ç»„ä»¶" aria-hidden="true" class="header-anchor">#</a> ä¸€è¡Œä»£ç å®ç°è¯„åˆ†ç»„ä»¶</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">genRate</span><span class="token punctuation">(</span>rate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'â˜…â˜…â˜…â˜…â˜…â˜†â˜†â˜†â˜†â˜†'</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">-</span> rate<span class="token punctuation">,</span> <span class="token number">10</span> <span class="token operator">-</span> rate<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="åä¸€æœˆ"><a href="#åä¸€æœˆ" aria-hidden="true" class="header-anchor">#</a> åä¸€æœˆ</h2> <h3 id="nodejs-ä¸€äº›è·¯å¾„å¸¸è¯†"><a href="#nodejs-ä¸€äº›è·¯å¾„å¸¸è¯†" aria-hidden="true" class="header-anchor">#</a> nodejs ä¸€äº›è·¯å¾„å¸¸è¯†</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å½“å‰æ–‡ä»¶æ‰§è¡Œè·¯å¾„</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å½“å‰ç¨‹åºè¿è¡Œè·¯å¾„ï¼Œä¹Ÿå°±æ˜¯åœ¨å“ªå¼€å§‹ node xxx çš„</span>

<span class="token comment">// path.resolve()æ–¹æ³•å¯ä»¥å°†å¤šä¸ªè·¯å¾„è§£æä¸ºä¸€ä¸ªè§„èŒƒåŒ–çš„ç»å¯¹è·¯å¾„</span>
<span class="token comment">// path.join()æ–¹æ³•å¯ä»¥è¿æ¥ä»»æ„å¤šä¸ªè·¯å¾„å­—ç¬¦ä¸²</span>

<span class="token keyword">const</span> path1 <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'/a/b'</span><span class="token punctuation">,</span> <span class="token string">'/c/d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>path1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// /c/d</span>

<span class="token keyword">const</span> path2 <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'/a/b'</span><span class="token punctuation">,</span> <span class="token string">'/c/d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>path2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// /a/b/c/d</span>
</code></pre></div><h3 id="åœ¨-node-ä¸­ä¸èƒ½ä½¿ç”¨exports-xxxçš„åŸå› "><a href="#åœ¨-node-ä¸­ä¸èƒ½ä½¿ç”¨exports-xxxçš„åŸå› " aria-hidden="true" class="header-anchor">#</a> åœ¨ node ä¸­ä¸èƒ½ä½¿ç”¨<code>exports=xxx</code>çš„åŸå› </h3> <p>åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œnode å¯¹è·å–çš„ javaScript æ–‡ä»¶å†…å®¹è¿›è¡Œäº†å¤´å°¾åŒ…è£…</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> require<span class="token punctuation">,</span> module<span class="token punctuation">,</span> __filename<span class="token punctuation">,</span> __dirname<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// exportså…¶å®æ˜¯module.exportsçš„ä¸€ä¸ªå¼•ç”¨ï¼Œå¦‚æœä½ ç›´æ¥å¯¹exportsè¿›è¡Œèµ‹å€¼ï¼Œé‚£module.exportsçš„å€¼æ˜¯ä¸ä¼šæ”¹å˜çš„</span>
  <span class="token comment">// æœ€ç»ˆå¯¼å‡ºçš„ä¹Ÿæ˜¯module.exportsçš„å€¼</span>
  <span class="token comment">// æ‰€ä»¥å°½é‡ä½¿ç”¨ module.exports = xxx</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> require<span class="token punctuation">,</span> module<span class="token punctuation">,</span> __filename<span class="token punctuation">,</span> __dirname<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
</code></pre></div><h3 id="isnan-å’Œ-number-isnan-çš„åŒºåˆ«"><a href="#isnan-å’Œ-number-isnan-çš„åŒºåˆ«" aria-hidden="true" class="header-anchor">#</a> isNaN å’Œ Number.isNaN çš„åŒºåˆ«</h3> <p>isNaNä¼šæŠŠå‚æ•°è½¬ä¸ºæ•°å€¼ï¼Œä»»ä½•ä¸èƒ½è¢«è½¬æ¢ä¸ºæ•°å€¼çš„å€¼éƒ½ä¼šè¿”å›trueï¼Œæ‰€ä»¥éæ•°å­—å€¼ä¼ å…¥ä¼šè¿”å›ï¼Œä¸è¿‡</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">isNaN</span><span class="token punctuation">(</span>undefined<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre></div><p>è¿™æ˜¯å› ä¸º<code>Number(undefined)</code>çš„å€¼ä¸º<code>NaN</code></p> <p>æ‰€ä»¥ï¼Œè¿™ä¼šå½±å“ NaN çš„åˆ¤æ–­</p> <p><code>Number.isNaN</code>ä¼šå…ˆåˆ¤æ–­ä¼ å…¥çš„å€¼æ˜¯ä¸æ˜¯æ•°å­—ï¼Œæ˜¯æ•°å­—å†è¿›è¡Œ<code>NaN</code>åˆ¤æ–­</p> <div class="language-js extra-class"><pre class="language-js"><code>Number<span class="token punctuation">.</span>isNaN <span class="token operator">=</span> Number<span class="token punctuation">.</span>isNaN <span class="token operator">||</span> <span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'number'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isNaN</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ‰€ä»¥ä½¿ç”¨<code>Number.isNaN</code>åˆ¤æ–­<code>NaN</code>æ›´ä¸ºå‡†ç¡®</p> <h3 id="chrome-devtool-network-è¯·æ±‚æ—¶åºä¿¡æ¯"><a href="#chrome-devtool-network-è¯·æ±‚æ—¶åºä¿¡æ¯" aria-hidden="true" class="header-anchor">#</a> chrome devtool network è¯·æ±‚æ—¶åºä¿¡æ¯</h3> <ul><li>Queueing: æµè§ˆå™¨åœ¨ä»¥ä¸‹æƒ…å†µä¸‹å°†è¯·æ±‚æ’é˜Ÿï¼š
æœ‰æ›´é«˜ä¼˜å…ˆçº§çš„è¯·æ±‚ã€‚
å·²ä¸ºè¯¥æ¥æºæ‰“å¼€äº†å…­ä¸ªTCPè¿æ¥ï¼Œè¿™æ˜¯é™åˆ¶ã€‚ä»…é€‚ç”¨äºHTTP / 1.0å’ŒHTTP / 1.1ã€‚
æµè§ˆå™¨æ­£åœ¨ç£ç›˜ç¼“å­˜ä¸­çŸ­æš‚åˆ†é…ç©ºé—´</li> <li>Stalled: ä»TCPè¿æ¥å»ºç«‹å®Œæˆï¼Œåˆ°çœŸæ­£å¯ä»¥ä¼ è¾“æ•°æ®ä¹‹é—´çš„æ—¶é—´å·®ï¼Œæ­¤æ—¶é—´åŒ…æ‹¬ä»£ç†åå•†æ—¶é—´</li> <li>DNS Lookup: æµè§ˆå™¨è§£æè¯·æ±‚IPåœ°å€æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯DNSæŸ¥æ‰¾æ—¶é—´</li> <li>Initial connection: æµè§ˆå™¨è¿›è¡ŒTCPæ¡æ‰‹/é‡è¯•/åå•†SSLèŠ±è´¹çš„æ—¶é—´</li> <li>Proxy negotiation: æµè§ˆå™¨ä¸ä»£ç†æœåŠ¡å™¨åå•†è¯·æ±‚çš„æ—¶é—´</li> <li>Request sent: æ­£åœ¨å‘é€è¯·æ±‚</li> <li>ServiceWorker Preparation: å‡†å¤‡ServiceWorker</li> <li>Request to ServiceWorker: å‘ServiceWorkerå‘é€è¯·æ±‚</li> <li>Waiting (TTFB): å‘é€è¯·æ±‚åˆ°æ¥æ”¶åˆ°å“åº”ç¬¬ä¸€ä¸ªå­—èŠ‚çš„æ—¶é—´æ€»å’Œã€‚TTFBä»£è¡¨åˆ°ç¬¬ä¸€ä¸ªå­—èŠ‚çš„æ—¶é—´ã€‚åŒ…å«ä¸€æ¬¡å¾€è¿”å»¶è¿Ÿå’ŒæœåŠ¡å™¨å‡†å¤‡å“åº”æ‰€èŠ±è´¹çš„æ—¶é—´</li> <li>Content Download: æ¥æ”¶å“åº”æ•°æ®æ‰€èŠ±è´¹çš„æ—¶é—´</li> <li>Receiving Push: æµè§ˆå™¨æ­£åœ¨é€šè¿‡HTTP/2æœåŠ¡å™¨æ¨é€æ¥æ”¶æ­¤å“åº”çš„æ•°æ®</li> <li>Reading Push: æµè§ˆå™¨æ­£åœ¨è¯»å–å…ˆå‰æ¥æ”¶çš„æœ¬åœ°æ•°æ®</li></ul> <h3 id="å…³äºvueçš„keyå‡ ä¸ªé—®é¢˜è®¨è®º"><a href="#å…³äºvueçš„keyå‡ ä¸ªé—®é¢˜è®¨è®º" aria-hidden="true" class="header-anchor">#</a> å…³äºvueçš„keyå‡ ä¸ªé—®é¢˜è®¨è®º</h3> <ul><li>ä¸ºä»€ä¹ˆv-forè¦åŠ keyï¼Ÿ</li></ul> <p>ç­”ï¼šä¸ºäº†å¤ç”¨æ—§èŠ‚ç‚¹vnodeï¼Œé¿å…ç»„ä»¶çš„é‡æ–°åˆ›å»ºå’Œé”€æ¯ï¼Œæé«˜æ€§èƒ½ã€‚å› ä¸ºåˆ¤æ–­æ˜¯å¦ä¸ºåŒä¸ªèŠ‚ç‚¹sameVnodeå‡½æ•°ï¼Œæœ‰ä¸€é¡¹æ˜¯æ ¹æ®keyæ¥è¿›è¡Œåˆ¤æ–­çš„ï¼Œå¦‚æœæ²¡æœ‰keyï¼Œé‚£å°±ç­‰äºå…¨éƒ¨ç»„ä»¶èŠ‚ç‚¹éƒ½è¦é‡æ–°åˆ›å»ºå’Œé”€æ¯ï¼Œå¦‚æœæä¾›äº†keyï¼Œæ–°æ—§èŠ‚ç‚¹æ˜¯ä¸€æ ·ï¼Œæœ€å¤šå°±ç§»åŠ¨ä¸‹ä½ç½®å°±å¯ä»¥äº†ã€‚</p> <ul><li>ä¸ºä»€ä¹ˆä¸è¦ç”¨ç´¢å¼•indexã€éšæœºæ•°å½“keyï¼Ÿ</li></ul> <p>ç­”ï¼šåŒæ ·æ˜¯æ— æ³•è¾¾åˆ°æ€§èƒ½ä¸Šçš„ä¼˜åŒ–ï¼Œæœ‰å‡ ç§æƒ…å†µï¼Œåˆ†ç‚¹è®¨è®º</p> <p>1ã€å¦‚æœæ¸²æŸ“æ•°ç»„çš„é¡ºåºç¿»è½¬ï¼Œindexå€¼è™½ç„¶ä¸ä¼šå˜ï¼ŒèŠ‚ç‚¹å†…å®¹æ”¹å˜äº†ï¼Œå¦‚æœæ˜¯çº¯æ ‡ç­¾<code>&lt;li&gt;</code>è¿™äº›ï¼Œvueå°±ç›´æ¥æ”¹å˜å…ƒç´ å†…å®¹ï¼Œä½†æ˜¯ï¼Œå¦‚æœæ˜¯ç»„ä»¶ï¼Œæœ‰propsçš„æƒ…å†µä¸‹ï¼Œdiffè¿‡ç¨‹ä¼šå‘ç°propsçš„æ”¹å˜ï¼Œç„¶åè§¦å‘ç»„ä»¶çš„è§†å›¾é‡æ–°æ¸²æŸ“ï¼Œå¿…ç„¶ä¼šå¯¼è‡´domçš„æ“ä½œã€‚</p> <p>2ã€å¦‚æœæ˜¯åœ¨æ•°ç»„<code>[1,2,3]</code>ä¸­æ’å…¥ä¸€ä¸ªå€¼ï¼Œå˜æˆ<code>[1,4,2,3]</code>ï¼Œé‚£ä¹ˆä¹‹å‰<code>2,3</code>ç»„ä»¶çš„ç´¢å¼•(key)ç”±<code>1,2</code>å˜æˆ<code>2,3</code>ï¼Œkeyå˜äº†ï¼ŒsameVnodeè‚¯å®šä¸ºfalseï¼Œæœ¬æ¥åªéœ€è¦æ–°å»º1ä¸ªç»„ä»¶ï¼Œç°åœ¨å˜æˆè¦æ–°å»º3ä¸ªï¼Œæ›´æ–°æˆæœ¬å¢åŠ ã€‚</p> <p>3ã€çœ‹çœ‹è¿™ç§æƒ…å†µ</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(val, idx) in arr<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>idx<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>comp</span> <span class="token attr-name">:val</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>idx<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>æµ‹è¯•<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
   arr<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
  	<span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
   <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>arr<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
   comp<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'val'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;span&gt;{{val}}&lt;/span&gt;`</span></span>
   <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>å¦‚æœæ˜¯æ•°ç»„<code>[1,2,3]</code>ï¼Œä½¿ç”¨<code>splice(0,1)</code>åˆ é™¤ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¹‹å‰èŠ‚ç‚¹ç´¢å¼•keyä¸º<code>[1,2,3] -&gt; 0,1,2</code>ï¼Œç°åœ¨å˜æˆ<code>[2,3] -&gt; 0,1</code>ï¼Œç»è¿‡vueçš„æ¯”è¾ƒé€»è¾‘ï¼Œå› ä¸ºkeyéƒ½æœ‰<code>0,1</code>ï¼Œæ‰€ä»¥vueä¼šè®¤ä¸ºå‰é¢2ä¸ªèŠ‚ç‚¹éƒ½æ²¡å˜ï¼Œå˜å¾—æ˜¯å°‘äº†keyä¸º2çš„èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€ä¸ªï¼Œæ‰€ä»¥å‰é¢2ä¸ªèŠ‚ç‚¹ç›´æ¥å¤ç”¨ï¼Œåœ¨è§†å›¾ä¸­ä½ ä¼šå‘ç°vueå°±æŠŠæœ€åä¸€ä¸ªèŠ‚ç‚¹ç»™åˆ äº†ã€‚</p> <p>ä½†æ˜¯ï¼Œå¦‚æœä½ ç›´æ¥ä½¿ç”¨<code>&lt;li v-for=&quot;(val, idx) in arr&quot; :key=&quot;idx&quot;&gt;&lt;/li&gt;</code>ï¼Œä½ ä¼šå¯Ÿè§‰ä¸åˆ°æ˜¯åˆ äº†æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºvueåœ¨diffè¿‡ç¨‹ä¸­ï¼Œå‘ç°äº†<code>li</code>æ˜¯æ–‡æœ¬èŠ‚ç‚¹ï¼Œåœ¨<code>patchVnode</code>å‡½æ•°æœ‰æ®µé€»è¾‘</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>oldVnode<span class="token punctuation">.</span>text <span class="token operator">!==</span> vnode<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 nodeOps<span class="token punctuation">.</span><span class="token function">setTextContent</span><span class="token punctuation">(</span>elm<span class="token punctuation">,</span> vnode<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>[1,2,3] -&gt; [2,3]</code>ï¼Œæ•°ç»„æ–‡æœ¬æ”¹å˜ï¼Œç›´æ¥æ›´æ–°domï¼Œæ‰€ä»¥ä½ æ— æ³•å¯Ÿè§‰ï¼Œä½†æ˜¯åº•å±‚æ˜¯åˆ é™¤äº†æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥å•Šï¼Œè¿˜æ˜¯ç»™ä¸€ä¸ªç¨³å®šçš„idåškeyå§~</p> <ul><li>keyç”¨éšæœºæ•°çš„æƒ…å†µ</li></ul> <p>keyç”¨éšæœºæ•°çš„è¯ï¼Œè¿™æ ·æ–°æ—§vnodeçš„keyå…¨éƒ½ä¸ä¸€æ ·ï¼Œå¾ˆå°´å°¬ï¼Œvueç›´æ¥åˆ¤æ–­å…¨éƒ½ä¸æ˜¯sameVnodeï¼Œå…¨éƒ¨é‡å¤´å†æ¥~</p> <h3 id="vue-diffç®—æ³•ç›¸å…³åˆ†æ"><a href="#vue-diffç®—æ³•ç›¸å…³åˆ†æ" aria-hidden="true" class="header-anchor">#</a> vue diffç®—æ³•ç›¸å…³åˆ†æ</h3> <p>æºç <code>core/vdom/patch.js</code></p> <p>ä¸ºä»€ä¹ˆè¦diffï¼Ÿ</p> <p>å‡å°‘domçš„æ›´æ–°é‡ï¼Œæ‰¾åˆ°æœ€å°å·®å¼‚éƒ¨åˆ†çš„domï¼Œä¹Ÿå°±æ˜¯å°½å¯èƒ½çš„å¤ç”¨æ—§èŠ‚ç‚¹ï¼Œæœ€ååªæ›´æ–°æ–°çš„éƒ¨åˆ†å³å¯ï¼ŒèŠ‚çœdomçš„æ–°å¢å’Œåˆ é™¤ç­‰æ“ä½œ</p> <p>æ–°æ—§èŠ‚ç‚¹æ¯”è¾ƒæµç¨‹ï¼š</p> <p>å‰ç½®æ¡ä»¶ä¸ºsameVnodeï¼Œåˆ™æ–°æ—§èŠ‚ç‚¹ç›¸åŒï¼Œç„¶åå†å»diffå®ƒä»¬çš„å­èŠ‚ç‚¹</p> <p>å¦‚ä½•åˆ¤æ–­ç›¸åŒèŠ‚ç‚¹ï¼Ÿ</p> <p>æºç æ˜¯è¿™æ ·å­çš„</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sameVnode</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    a<span class="token punctuation">.</span>key <span class="token operator">===</span> b<span class="token punctuation">.</span>key <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
      <span class="token punctuation">(</span>
        a<span class="token punctuation">.</span>tag <span class="token operator">===</span> b<span class="token punctuation">.</span>tag <span class="token operator">&amp;&amp;</span>
        a<span class="token punctuation">.</span>isComment <span class="token operator">===</span> b<span class="token punctuation">.</span>isComment <span class="token operator">&amp;&amp;</span>
        <span class="token function">isDef</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">isDef</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        <span class="token function">sameInputType</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
      <span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>
        <span class="token function">isTrue</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>isAsyncPlaceholder<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        a<span class="token punctuation">.</span>asyncFactory <span class="token operator">===</span> b<span class="token punctuation">.</span>asyncFactory <span class="token operator">&amp;&amp;</span>
        <span class="token function">isUndef</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>asyncFactory<span class="token punctuation">.</span>error<span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åŸç†ä¸»è¦æ˜¯åˆ¤æ–­vnodeçš„<code>key</code>ã€<code>tag</code>ã€<code>æ˜¯å¦æ˜¯æ³¨é‡ŠèŠ‚ç‚¹</code>ã€<code>æ˜¯å¦æœ‰data</code>ã€<code>æ˜¯å¦ä¸ºç›¸åŒçš„input type</code></p> <p>æ¥ç€ï¼Œçœ‹çœ‹patchå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯<code>Vue.prototype.__patch__</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">patch</span> <span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">,</span> hydrating<span class="token punctuation">,</span> removeOnly<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isUndef</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">invokeDestroyHook</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">)</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> isInitialPatch <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token keyword">const</span> insertedVnodeQueue <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token comment">// å¦‚æœæ²¡æœ‰æ—§èŠ‚ç‚¹ï¼Œç›´æ¥ç”Ÿæˆæ–°èŠ‚ç‚¹</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isUndef</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// empty mount (likely as component), create new root element</span>
      isInitialPatch <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token function">createElm</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> insertedVnodeQueue<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> isRealElement <span class="token operator">=</span> <span class="token function">isDef</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">.</span>nodeType<span class="token punctuation">)</span>
      <span class="token comment">// å¦‚æœæ˜¯ä¸€æ ·çš„vnodeï¼Œåˆ™æ¯”è¾ƒå­˜åœ¨çš„æ ¹èŠ‚ç‚¹</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isRealElement <span class="token operator">&amp;&amp;</span> <span class="token function">sameVnode</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// patch existing root node</span>
        <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">,</span> insertedVnodeQueue<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> removeOnly<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>isRealElement<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// mounting to a real element</span>
          <span class="token comment">// check if this is server-rendered content and if we can perform</span>
          <span class="token comment">// a successful hydration.</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>oldVnode<span class="token punctuation">.</span>nodeType <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> oldVnode<span class="token punctuation">.</span><span class="token function">hasAttribute</span><span class="token punctuation">(</span><span class="token constant">SSR_ATTR</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            oldVnode<span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token constant">SSR_ATTR</span><span class="token punctuation">)</span>
            hydrating <span class="token operator">=</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isTrue</span><span class="token punctuation">(</span>hydrating<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">hydrate</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">,</span> insertedVnodeQueue<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token function">invokeInsertHook</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> insertedVnodeQueue<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
              <span class="token keyword">return</span> oldVnode
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token function">warn</span><span class="token punctuation">(</span>
                <span class="token string">'The client-side rendered virtual DOM tree is not matching '</span> <span class="token operator">+</span>
                <span class="token string">'server-rendered content. This is likely caused by incorrect '</span> <span class="token operator">+</span>
                <span class="token string">'HTML markup, for example nesting block-level elements inside '</span> <span class="token operator">+</span>
                <span class="token string">'&lt;p&gt;, or missing &lt;tbody&gt;. Bailing hydration and performing '</span> <span class="token operator">+</span>
                <span class="token string">'full client-side render.'</span>
              <span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
          <span class="token comment">// either not server-rendered, or hydration failed.</span>
          <span class="token comment">// create an empty node and replace it</span>
          oldVnode <span class="token operator">=</span> <span class="token function">emptyNodeAt</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// replacing existing element</span>
        <span class="token keyword">const</span> oldElm <span class="token operator">=</span> oldVnode<span class="token punctuation">.</span>elm
        <span class="token keyword">const</span> parentElm <span class="token operator">=</span> nodeOps<span class="token punctuation">.</span><span class="token function">parentNode</span><span class="token punctuation">(</span>oldElm<span class="token punctuation">)</span>

        <span class="token comment">// create new node</span>
        <span class="token comment">// åˆ›å»ºæ–°èŠ‚ç‚¹</span>
        <span class="token function">createElm</span><span class="token punctuation">(</span>
          vnode<span class="token punctuation">,</span>
          insertedVnodeQueue<span class="token punctuation">,</span>
          <span class="token comment">// extremely rare edge case: do not insert if old element is in a</span>
          <span class="token comment">// leaving transition. Only happens when combining transition +</span>
          <span class="token comment">// keep-alive + HOCs. (#4590)</span>
          oldElm<span class="token punctuation">.</span>_leaveCb <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token punctuation">:</span> parentElm<span class="token punctuation">,</span>
          nodeOps<span class="token punctuation">.</span><span class="token function">nextSibling</span><span class="token punctuation">(</span>oldElm<span class="token punctuation">)</span>
        <span class="token punctuation">)</span>

        <span class="token comment">// update parent placeholder node element, recursively</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>parent<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">let</span> ancestor <span class="token operator">=</span> vnode<span class="token punctuation">.</span>parent
          <span class="token keyword">const</span> patchable <span class="token operator">=</span> <span class="token function">isPatchable</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span>
          <span class="token keyword">while</span> <span class="token punctuation">(</span>ancestor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cbs<span class="token punctuation">.</span>destroy<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              cbs<span class="token punctuation">.</span>destroy<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">(</span>ancestor<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            ancestor<span class="token punctuation">.</span>elm <span class="token operator">=</span> vnode<span class="token punctuation">.</span>elm
            <span class="token keyword">if</span> <span class="token punctuation">(</span>patchable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cbs<span class="token punctuation">.</span>create<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                cbs<span class="token punctuation">.</span>create<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">(</span>emptyNode<span class="token punctuation">,</span> ancestor<span class="token punctuation">)</span>
              <span class="token punctuation">}</span>
              <span class="token comment">// #6513</span>
              <span class="token comment">// invoke insert hooks that may have been merged by create hooks.</span>
              <span class="token comment">// e.g. for directives that uses the &quot;inserted&quot; hook.</span>
              <span class="token keyword">const</span> insert <span class="token operator">=</span> ancestor<span class="token punctuation">.</span>data<span class="token punctuation">.</span>hook<span class="token punctuation">.</span>insert
              <span class="token keyword">if</span> <span class="token punctuation">(</span>insert<span class="token punctuation">.</span>merged<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// start at index 1 to avoid re-invoking component mounted hook</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> insert<span class="token punctuation">.</span>fns<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  insert<span class="token punctuation">.</span>fns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
              <span class="token function">registerRef</span><span class="token punctuation">(</span>ancestor<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            ancestor <span class="token operator">=</span> ancestor<span class="token punctuation">.</span>parent
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// destroy old node</span>
        <span class="token comment">// é”€æ¯æ—§èŠ‚ç‚¹</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">removeVnodes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>oldVnode<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">.</span>tag<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">invokeDestroyHook</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">invokeInsertHook</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> insertedVnodeQueue<span class="token punctuation">,</span> isInitialPatch<span class="token punctuation">)</span>
    <span class="token comment">// vm.$el</span>
    <span class="token keyword">return</span> vnode<span class="token punctuation">.</span>elm
  <span class="token punctuation">}</span>
</code></pre></div><p>æºç å¤ªé•¿ï¼Œç²¾ç®€ä¸€ä¸‹</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">patch</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>oldVnode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">createElm</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">createElm</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">removeVnodes</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">return</span> vnode<span class="token punctuation">.</span>elm<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>patchå‡½æ•°å…¶å®å°±æ˜¯åˆ†ä¸ºä¸‰ä¸ªæµç¨‹</p> <p>1ã€æ²¡æœ‰æ—§èŠ‚ç‚¹ï¼Œç›´æ¥å…¨éƒ¨æ–°å»º</p> <p>2ã€æ—§èŠ‚ç‚¹å’Œæ–°èŠ‚ç‚¹è‡ªèº«ä¸€æ ·ï¼Œåˆ™å»æ¯”è¾ƒå®ƒä»¬çš„å­èŠ‚ç‚¹</p> <p>3ã€æ—§èŠ‚ç‚¹å’Œæ–°èŠ‚ç‚¹ä¸ä¸€æ ·ï¼Œåˆ™åˆ›å»ºæ–°èŠ‚ç‚¹ï¼Œåˆ é™¤æ—§èŠ‚ç‚¹</p> <p>ç¬¬äºŒä¸ªæµç¨‹ä¸­ï¼Œå­èŠ‚ç‚¹çš„diffï¼ˆæ–°æ—§èŠ‚ç‚¹å¿…é¡»æ˜¯sameVnodeï¼‰</p> <p>æ¯”è¾ƒæ–°æ—§èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼Œæ ¸å¿ƒå°±æ˜¯<code>updateChildren</code>å‡½æ•°ï¼Œå¾ªç¯å¯¹æ¯”</p> <p>ç®€å•æ¦‚å†µå°±æ˜¯ï¼š</p> <p>1ã€å…ˆæ‰¾åˆ°ä¸éœ€è¦ç§»åŠ¨çš„ç›¸åŒèŠ‚ç‚¹ï¼ˆæ–°å¤´æ—§å¤´ã€æ–°å°¾æ—§å°¾åˆ¤æ–­ï¼‰ï¼Œæ¶ˆè€—æœ€å°</p> <p>2ã€å†æ‰¾ç›¸åŒä½†æ˜¯éœ€è¦ç§»åŠ¨çš„èŠ‚ç‚¹ï¼ˆæ–°å¤´æ—§å°¾ã€æ–°å°¾æ—§å¤´ã€å•ä¸ªæŸ¥æ‰¾ï¼‰ï¼Œæ¶ˆè€—ç¬¬äºŒå°</p> <p>3ã€æœ€åæ‰¾ä¸åˆ°ï¼Œæ‰ä¼šå»æ–°å»ºåˆ é™¤èŠ‚ç‚¹ï¼Œä¿åº•å¤„ç†</p> <p>å†ç»†è¯´ä¸‹ï¼š</p> <p>1ã€æ—§å¤´å’Œæ–°å¤´æ¯”è¾ƒï¼Œå¦‚æœä¸€æ ·åˆ™ä¸ç§»åŠ¨</p> <p>2ã€æ—§å°¾å’Œæ—§å°¾æ¯”è¾ƒï¼Œå¦‚æœä¸€æ ·åˆ™ä¸ç§»åŠ¨</p> <p>3ã€æ—§å¤´å’Œæ–°å°¾æ¯”è¾ƒï¼Œå¦‚æœä¸€æ ·åˆ™æ“ä½œdomï¼ŒæŠŠæ—§å¤´ç§»åŠ¨åˆ°å°¾éƒ¨</p> <p>4ã€æ—§å°¾å’Œæ–°å¤´æ¯”è¾ƒï¼Œå¦‚æœä¸€æ ·åˆ™æ“ä½œdomï¼ŒæŠŠæ—§å°¾ç§»åŠ¨åˆ°å¤´éƒ¨</p> <p>5ã€æ‹¿æ–°èŠ‚ç‚¹å»æ—§å­èŠ‚ç‚¹æ•°ç»„ä¸­éå†ï¼Œå­˜åœ¨ä¸”sameNodeä¸ºtrueå°±ç§»åŠ¨æ—§èŠ‚ç‚¹ï¼Œä¸å­˜åœ¨å°±æ–°å»ºèŠ‚ç‚¹</p> <p>6ã€å¦‚æœæ–°å­èŠ‚ç‚¹éå†å®Œäº†ï¼Œæ—§å­èŠ‚ç‚¹æœ‰å‰©ä½™ï¼Œè®©domé€ä¸ªåˆ é™¤æ—§èŠ‚ç‚¹</p> <p>7ã€å¦‚æœæ—§å­èŠ‚ç‚¹éå†å®Œäº†ï¼Œæ–°å­èŠ‚ç‚¹æœ‰å‰©ä½™ï¼Œå…¨éƒ¨æ–°å»ºå­èŠ‚ç‚¹</p> <p>è¿™æ ·diffçš„åŸå› ï¼Œå°±æ˜¯ä¸ºäº†æ›´é«˜æ•ˆæ‰¾åˆ°å’Œæ–°èŠ‚ç‚¹ä¸€æ ·çš„æ—§èŠ‚ç‚¹ï¼Œç„¶ååªéœ€è¦ç§»åŠ¨ä½ç½®å°±å¯ä»¥äº†ï¼Œé¿å…äº†é‡æ–°åˆ›å»º/åˆ é™¤dom</p> <h2 id="åäºŒæœˆ"><a href="#åäºŒæœˆ" aria-hidden="true" class="header-anchor">#</a> åäºŒæœˆ</h2> <h3 id="base64æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#base64æ˜¯ä»€ä¹ˆï¼Ÿ" aria-hidden="true" class="header-anchor">#</a> base64æ˜¯ä»€ä¹ˆï¼Ÿ</h3> <p>Base64æ˜¯ä¸€ç§åŸºäº64ä¸ªå¯æ‰“å°å­—ç¬¦æ¥è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®çš„è¡¨ç¤ºæ–¹æ³•ã€‚ç”±äº<code>log264 = 6</code>ï¼Œæ‰€ä»¥æ¯6ä¸ªæ¯”ç‰¹ä½å…ƒä¸ºä¸€ä¸ªå•å…ƒï¼Œå¯¹åº”æŸä¸ªå¯æ‰“å°å­—ç¬¦ã€‚1ä¸ªå­—èŠ‚ç­‰äº8æ¯”ç‰¹ä½ï¼Œ3ä¸ªå­—èŠ‚ç›¸å½“äº24ä¸ªæ¯”ç‰¹ä½ï¼Œå¯¹åº”äº4ä¸ªBase64å•å…ƒï¼Œå³3ä¸ªå­—èŠ‚å¯ç”±4ä¸ªå¯æ‰“å°å­—ç¬¦æ¥è¡¨ç¤ºã€‚</p> <h3 id="å¼‚æ­¥æ¨¡å—æ‰“åŒ…æ‰§è¡Œæµç¨‹"><a href="#å¼‚æ­¥æ¨¡å—æ‰“åŒ…æ‰§è¡Œæµç¨‹" aria-hidden="true" class="header-anchor">#</a> å¼‚æ­¥æ¨¡å—æ‰“åŒ…æ‰§è¡Œæµç¨‹</h3> <p>å½“ä¸€ä¸ªæ–‡ä»¶è¢«å¼‚æ­¥åŠ è½½ï¼Œåœ¨<code>index.js</code>ä¸­è¿™ä¹ˆå†™</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/*webpackChunkName: &quot;async&quot;*/</span><span class="token string">'./async'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token keyword">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>è¢«webpackå¤„ç†è¿‡åindex.jsçš„æ ·å­ï¼Œå‰”é™¤å¼•å¯¼æ¨¡æ¿runtime</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span>window<span class="token punctuation">[</span><span class="token string">&quot;webpackJsonp&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> window<span class="token punctuation">[</span><span class="token string">&quot;webpackJsonp&quot;</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;app&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">{</span>

<span class="token comment">/***/</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">:</span>
<span class="token comment">/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/</span>
<span class="token comment">/*! no static exports found */</span>
<span class="token comment">/***/</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>module<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">)</span> <span class="token punctuation">{</span>

__webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token comment">/*! import() | async */</span> <span class="token string">&quot;async&quot;</span><span class="token punctuation">)</span>
  <span class="token comment">// éœ€è¦è¢«__webpack_require__åŠ è½½</span>
  <span class="token comment">// __webpack_require__ è¿”å› module.exports</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token comment">/*! ./async */</span> <span class="token string">&quot;./src/async.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  	res<span class="token punctuation">.</span><span class="token keyword">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">/***/</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;runtime&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å‡ºç°2ä¸ªå…³é”®å­—ï¼Œä¸€ä¸ª<code>webpackJsonp</code>ï¼Œä¸€ä¸ª<code>__webpack_require__.e</code></p> <p><code>webpackJson.push</code>å…¶å®å·²ç»è¢«é‡å†™äº†ï¼Œå¹¶ä¸æ˜¯<code>Array.prototype.push</code>ï¼Œè€Œæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå«<code>webpackJsonpCallback</code>ï¼Œä¸ºä»€ä¹ˆå«<code>jsonpCallbak</code>?å…¶å®å¾ˆå¥½ç†è§£ï¼Œå¼‚æ­¥çš„chunkæ˜¯é€šè¿‡scriptæ ‡ç­¾åŠ è½½çš„ï¼Œè·ŸjsonpåŸç†ä¸€æ ·ã€‚å½“å¼‚æ­¥chunkä¸‹è½½å®Œåï¼Œé¦–å…ˆå°±æ˜¯æ‰§è¡Œè¿™ä¸ª<code>webpackJsonpCallback</code>å‡½æ•°ï¼Œçœ‹çœ‹è¿™ä¸ªå‡½æ•°</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/******/</span> 	<span class="token keyword">function</span> <span class="token function">webpackJsonpCallback</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¼‚æ­¥åŠ è½½çš„æ–‡ä»¶ä¸­å­˜æ”¾çš„éœ€è¦å®‰è£…çš„æ¨¡å—å¯¹åº”çš„ Chunk ID</span>
<span class="token comment">/******/</span> 		<span class="token keyword">var</span> chunkIds <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">// å¼‚æ­¥åŠ è½½çš„æ–‡ä»¶ä¸­å­˜æ”¾çš„éœ€è¦å®‰è£…çš„æ¨¡å—åˆ—è¡¨</span>
<span class="token comment">/******/</span> 		<span class="token keyword">var</span> moreModules <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">// åœ¨å¼‚æ­¥åŠ è½½çš„æ–‡ä»¶ä¸­å­˜æ”¾çš„éœ€è¦å®‰è£…çš„æ¨¡å—éƒ½å®‰è£…æˆåŠŸåï¼Œéœ€è¦æ‰§è¡Œçš„æ¨¡å—å¯¹åº”çš„ index</span>
  					<span class="token comment">// æ¯”å¦‚ app.js å°±æ˜¯éœ€è¦æœ€å¼€å§‹æ‰§è¡Œçš„</span>
<span class="token comment">/******/</span> 		<span class="token keyword">var</span> executeModules <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">/******/</span>
<span class="token comment">/******/</span> 		<span class="token comment">// add &quot;moreModules&quot; to the modules object,</span>
<span class="token comment">/******/</span> 		<span class="token comment">// then flag all &quot;chunkIds&quot; as loaded and fire callback</span>
<span class="token comment">/******/</span> 		<span class="token keyword">var</span> moduleId<span class="token punctuation">,</span> chunkId<span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> resolves <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">/******/</span> 		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> chunkIds<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">/******/</span> 			chunkId <span class="token operator">=</span> chunkIds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">/******/</span> 			<span class="token keyword">if</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>hasOwnProperty<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>installedChunks<span class="token punctuation">,</span> chunkId<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> installedChunks<span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  							<span class="token comment">// installedChunks[chunkId][0] å°±æ˜¯ promise resolve å‡½æ•°</span>
<span class="token comment">/******/</span> 				resolves<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>installedChunks<span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/******/</span> 			<span class="token punctuation">}</span>
              <span class="token comment">// æ ‡è®°è¯¥chunkå·²ç»åŠ è½½å®Œæˆï¼Œ0å³å®Œæˆ</span>
<span class="token comment">/******/</span> 			installedChunks<span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">/******/</span> 		<span class="token punctuation">}</span>
            <span class="token comment">// æŠŠæ‰€æœ‰çš„æ¨¡å—åŠ å…¥ modules çš„å¯¹è±¡ä¸­, å°±æ˜¯ __webpack_require__.m å¯¹åº”çš„é‚£ä¸ªå±æ€§</span>
<span class="token comment">/******/</span> 		<span class="token keyword">for</span><span class="token punctuation">(</span>moduleId <span class="token keyword">in</span> moreModules<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">/******/</span> 			<span class="token keyword">if</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>hasOwnProperty<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>moreModules<span class="token punctuation">,</span> moduleId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">/******/</span> 				modules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span> <span class="token operator">=</span> moreModules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">/******/</span> 			<span class="token punctuation">}</span>
<span class="token comment">/******/</span> 		<span class="token punctuation">}</span>
<span class="token comment">/******/</span> 		<span class="token keyword">if</span><span class="token punctuation">(</span>parentJsonpFunction<span class="token punctuation">)</span> <span class="token function">parentJsonpFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/******/</span>    
<span class="token comment">/******/</span> 		<span class="token keyword">while</span><span class="token punctuation">(</span>resolves<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">/******/</span> 			resolves<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/******/</span> 		<span class="token punctuation">}</span>
<span class="token comment">/******/</span>
<span class="token comment">/******/</span> 		<span class="token comment">// add entry modules from loaded chunk to deferred list</span>
<span class="token comment">/******/</span> 		deferredModules<span class="token punctuation">.</span>push<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>deferredModules<span class="token punctuation">,</span> executeModules <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/******/</span>
<span class="token comment">/******/</span> 		<span class="token comment">// run deferred modules when all chunks ready</span>
  					<span class="token comment">// è¿™ä¸ªå‡½æ•°ä¹Ÿå¾ˆé‡è¦ï¼Œä¸»è¦æ˜¯å°±æ˜¯æ‰§è¡Œå…¥å£æ–‡ä»¶ï¼Œæ¯”å¦‚app.js</span>
<span class="token comment">/******/</span> 		<span class="token keyword">return</span> <span class="token function">checkDeferredModules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/******/</span> 	<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>è¿™ä¸ªå‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªæ•°ç»„å‚æ•°ï¼ŒåŒ…æ‹¬chunkidï¼ŒmoreModulesæ¨¡å—åˆ—è¡¨ï¼ŒexecuteModuleséœ€è¦å…ˆæ‰§è¡Œçš„æ¨¡å—</p> <p>å…·ä½“ä½œç”¨</p> <p>1ã€æ˜¯ç”¨æ¥æ ‡è¯†è¯¥chunkåŠ è½½å®Œæˆï¼Œå› ä¸ºåªæœ‰ä¸‹è½½å®Œæ‰ä¼šæ‰§è¡Œè¿™ä¸ªcallbackå‡½æ•°</p> <p>2ã€æŠŠmoreModulesï¼Œä¹Ÿå°±æ˜¯æŠŠç¬¬äºŒä¸ªå‚æ•°æ¨¡å—Mapå¯¹è±¡æ”¾åˆ°runtimeæœ€å¤–å±‚ä½œç”¨åŸŸçš„modulesæ•°ç»„ä¸­ï¼Œä¸ç„¶<code>__webpack_require__</code>æ‹¿ä¸åˆ°æ¨¡å—</p> <p>3ã€resolve<code>__webpack_require__.e</code>å‡½æ•°åŠ è½½chunkè¿”å›çš„promiseï¼Œé€šçŸ¥<code>__webpack_require__</code>å‡½æ•°åŠ è½½å’Œæ‰§è¡Œæ¨¡å—</p> <p>4ã€é“¾å¼è°ƒç”¨promiseï¼ŒæŠŠmoduleå½“å‚æ•°ï¼Œæ‰§è¡Œç”¨æˆ·å®šä¹‰çš„thenå›è°ƒ</p> <p>5ã€å¸¦æœ‰å…¥å£æ–‡ä»¶çš„è¯ï¼Œå°±å…ˆæ‰§è¡Œå…¥å£æ–‡ä»¶</p> <p><code>__webpack_require__.e</code>ç®€åŒ–ä»£ç ï¼Œåˆ†æå¦‚ä¸‹</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è®°å½•chunkçŠ¶æ€</span>
<span class="token comment">// key: id, value: çŠ¶æ€</span>
<span class="token comment">// undefined: æœªåŠ è½½</span>
<span class="token comment">// æ•°ç»„: åŠ è½½ä¸­</span>
<span class="token comment">// 0ï¼šå·²åŠ è½½</span>
<span class="token keyword">var</span> installedChunks <span class="token operator">=</span> <span class="token punctuation">{</span>
  
<span class="token punctuation">}</span>

__webpack<span class="token punctuation">.</span>require__<span class="token punctuation">.</span><span class="token function-variable function">e</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">requireEnsure</span><span class="token punctuation">(</span>chunkId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> promises <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>installedChunks<span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">new</span> <span class="token function">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	 		installedChunks<span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">]</span><span class="token punctuation">;</span>
 		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    promises<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>promise<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  	<span class="token keyword">var</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  	script<span class="token punctuation">.</span>charset <span class="token operator">=</span> <span class="token string">'utf-8'</span><span class="token punctuation">;</span>
  	script<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">120</span><span class="token punctuation">;</span><span class="token comment">// 120s è¿‡åå°±ä¸­æ–­</span>
  
  	script<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token function">jsonpScriptSrc</span><span class="token punctuation">(</span>chunkId<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// srcåŠ è½½</span>
  
  	<span class="token function-variable function">onScriptComplete</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
  	<span class="token punctuation">}</span>
  
  	<span class="token keyword">var</span> timeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'timeout'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">120000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    script<span class="token punctuation">.</span>onerror <span class="token operator">=</span> script<span class="token punctuation">.</span>onload <span class="token operator">=</span> onScriptComplete<span class="token punctuation">;</span>
    document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
    
  	<span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>promises<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªå‡½æ•°ä¸»è¦ä½œç”¨æ˜¯åŠ è½½chunkï¼Œè¿˜æœ‰ä¸ªchunkæ·»åŠ loadingçŠ¶æ€</p> <p>è¿™è¾¹è¿˜æ¼äº†ä¸ªåœ°æ–¹æ²¡è®²ï¼Œå°±æ˜¯æ‰“åŒ…åçš„<code>async.js</code>æ–‡ä»¶åˆ†æï¼Œä»¥åŠåŠ è½½<code>async.js</code>è¿‡ç¨‹</p> <p><code>async.js</code>æ–‡ä»¶</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">asyncModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async module'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> asyncModule<span class="token punctuation">;</span>
</code></pre></div><p>æ‰“åŒ…ä¹‹å</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span>window<span class="token punctuation">[</span><span class="token string">&quot;webpackJsonp&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> window<span class="token punctuation">[</span><span class="token string">&quot;webpackJsonp&quot;</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;async&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">{</span>

<span class="token comment">/***/</span> <span class="token string">&quot;./src/async.js&quot;</span><span class="token punctuation">:</span>
<span class="token comment">/*!**********************!*\
  !*** ./src/async.js ***!
  \**********************/</span>
<span class="token comment">/*! exports provided: default */</span>
<span class="token comment">/***/</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>module<span class="token punctuation">,</span> __webpack_exports__<span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>
__webpack_require__<span class="token punctuation">.</span><span class="token function">r</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">asyncModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async module'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* harmony default export */</span> __webpack_exports__<span class="token punctuation">[</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>asyncModule<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/***/</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œwebpackä¹Ÿæ˜¯æŠŠ<code>async.js</code>å‡½æ•°åŒ…è£…äº†ä¸€å±‚ï¼Œå…ˆç”¨<code>webpackJsonpCallback</code>å‡½æ•°æ ‡è¯†è¯¥chunkåŠ è½½å®Œæˆï¼Œå†æŠŠ<code>async.js</code>å†…å®¹æ”¾åˆ°æ¨¡å—æ•°ç»„ä¸­ï¼Œç„¶ååœ¨<code>index.js</code>çš„æ‰“åŒ…æ–‡ä»¶ä¸­åŠ è½½å†æ‰§è¡Œ</p> <p>æ‰§è¡Œ<code>async.js</code>é‡Œçš„<code>asyncModule</code>å‡½æ•°æ˜¯åœ¨<code>index.js</code>æ–‡ä»¶é‡Œé¢çš„ï¼Œå¾€ä¸Šçœ‹æ‰“åŒ…åçš„<code>index.js</code>æ–‡ä»¶ï¼Œæœ‰ä¸ªé€»è¾‘ï¼Œä¹Ÿå°±æ˜¯thenå›è°ƒé‡Œé¢çš„</p> <div class="language-js extra-class"><pre class="language-js"><code>__webpack_require__<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token comment">/*! ./async */</span> <span class="token string">&quot;./src/async.js&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>å…¶ä¸­ï¼Œ<code>async.js</code>æ¨¡å—å†…å®¹æ˜¯ç”¨<code>__webpack_require__</code>åŒæ­¥åŠ è½½æ‰§è¡Œçš„ï¼Œ<code>__webpack_require__</code>å‡½æ•°æ˜¯webpackåŠ è½½æ¨¡å—çš„æ ¸å¿ƒï¼Œå…ˆæ¥çœ‹çœ‹è¿™ä¸ªå‡½æ•°æºç </p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span>moduleId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// Check if module is in cache</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>installedModules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> installedModules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// Create a new module (and put it into the cache)</span>
	<span class="token keyword">var</span> module <span class="token operator">=</span> installedModules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
		i<span class="token punctuation">:</span> moduleId<span class="token punctuation">,</span>
		l<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
		exports<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token comment">// Execute the module function</span>
  <span class="token comment">// æ‰§è¡Œæ¨¡å—çš„å‡½æ•°ä½“ï¼Œä¹Ÿå°±æ˜¯asyncæ‰“åŒ…åçš„åŒ…è£…å‡½æ•°</span>
 	<span class="token comment">// moduleså°±æ˜¯å­˜æ”¾æ‰€æœ‰webpackæ¨¡å—çš„åœ°æ–¹</span>
	modules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> module<span class="token punctuation">,</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// Flag the module as loaded</span>
	module<span class="token punctuation">.</span>l <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token comment">// Return the exports of the module</span>
	<span class="token keyword">return</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åŠ è½½çš„åŸç†ä¹Ÿå¾ˆç®€å•äº†ï¼Œå°±æ˜¯ä¸€è¡Œä»£ç ï¼Œä»<code>modules</code>é‡Œé¢å–æ¨¡å—åŠ è½½</p> <div class="language-js extra-class"><pre class="language-js"><code>modules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> module<span class="token punctuation">,</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å¯¹åº”ç€<code>async.js</code>åŒ…è£…å‡½æ•°</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>module<span class="token punctuation">,</span> __webpack_exports__<span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>æ‰€ä»¥ï¼Œåœ¨å¼‚æ­¥æ¨¡å—åŠ è½½ä¹‹å‰ï¼Œä¸€å®šè¦æŠŠæ¨¡å—æ”¾åˆ°<code>modules</code>å˜é‡é‡Œé¢ï¼Œç„¶ååœ¨ç”¨<code>__webpack_require__</code>æ‰§è¡Œå³å¯</p> <p>é™„ä¸Šæµç¨‹å›¾</p> <p><img src="/Notebook/assets/img/image-20201202181100446.196b4283.png" alt="image-20201202181100446"></p> <p>æ‰€ä»¥ï¼Œå®Œå…¨å¯ä»¥è®©å¼‚æ­¥chunkåœ¨æµè§ˆå™¨ç©ºé—²çš„æ—¶å€™ä¸‹è½½ï¼Œå› ä¸ºè¿™äº›chunkä¸‹è½½ä¸éœ€è¦å…ˆåå›ºå®šé¡ºåºï¼Œå¯ä»¥ç”¨prefetchå¯¹æŸäº›å¼‚æ­¥è·¯ç”±è¿›è¡Œæå‰ä¸‹è½½ï¼Œæä¾›åŠ è½½é€Ÿåº¦ã€‚</p> <p>çœ‹å®Œæºç ä¸å¾—ä¸æƒŠå¹ï¼Œè¿™äº›åŠ è½½è¿‡ç¨‹ä¸éœ€è¦å¾ˆå¤šä»£ç ï¼Œå°±èƒ½æŠŠchunkä¹‹å‰å®Œå…¨è§£è€¦å¼€ï¼Œé—­åŒ…ç©å¾—å¤ªå¦™äº†ã€‚</p> <h3 id="webpack-æ¨¡å—åœ¨è¿è¡Œæ—¶æ˜¯æ€ä¹ˆå­˜çš„ï¼Ÿ"><a href="#webpack-æ¨¡å—åœ¨è¿è¡Œæ—¶æ˜¯æ€ä¹ˆå­˜çš„ï¼Ÿ" aria-hidden="true" class="header-anchor">#</a> webpack æ¨¡å—åœ¨è¿è¡Œæ—¶æ˜¯æ€ä¹ˆå­˜çš„ï¼Ÿ</h3> <p>æ¯ä¸ªæ¨¡å—éƒ½å­˜åœ¨webpackå‡½æ•°ä¸­çš„<code>modules</code>æ•°ç»„å˜é‡é‡Œé¢ï¼Œæ¯”å¦‚ä¸€ä¸ªidä¸º1çš„æ¨¡å—</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

modules<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  i<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// æ¨¡å—id</span>
	l<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// æ˜¯å¦å·²ç»åŠ è½½</span>
	exports<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// å¯¼å‡ºçš„å€¼</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å…¶ä¸­ï¼Œé€šè¿‡ä¸€ä¸ªè¡¨æ¥è¿›è¡Œå­˜å‚¨ï¼Œé”®ä¸ºæ¨¡å—idï¼Œå€¼ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢åŒ…å«äº†æ¨¡å—å±æ€§ã€‚</p> <h3 id="webpack-æŒä¹…åŒ–-chunk-ç¼“å­˜æ–¹æ¡ˆ"><a href="#webpack-æŒä¹…åŒ–-chunk-ç¼“å­˜æ–¹æ¡ˆ" aria-hidden="true" class="header-anchor">#</a> webpack æŒä¹…åŒ– chunk ç¼“å­˜æ–¹æ¡ˆ</h3> <p>jsã€cssæ–‡ä»¶ä¸èƒ½ä½¿ç”¨hashï¼Œå›¾ç‰‡ã€å­—ä½“ã€svgæ–‡ä»¶å¯ä»¥ä½¿ç”¨hash</p> <p>cssä½¿ç”¨contentHashï¼Œä½¿ç”¨chunkHashä¼šä½¿å¾—è·Ÿå…¶æœ‰cssæ–‡ä»¶å…³è”çš„jsæ–‡ä»¶hashå€¼éƒ½æ”¹å˜</p> <p>jsç°åœ¨ä¹Ÿå¯ä»¥ä½¿ç”¨contentHashäº†ï¼Œä½†æ˜¯æœ‰äº›æ—§ç‰ˆæœ¬webpackæ˜¯ä¸æ”¯æŒçš„</p> <p>å¦‚æœjsç”¨chunkHashçš„è¯ï¼Œé‡‡ç”¨ä»¥ä¸‹æ–¹æ¡ˆ</p> <p>1ã€éœ€è¦ç”¨HashedModuleIdsPluginå›ºå®šä½moduleId(å¦‚æœä¸ä½¿ç”¨ï¼Œwebpackåˆ™ä¼šä½¿ç”¨è‡ªå¢çš„idï¼Œå½“å¢åŠ æˆ–è€…åˆ é™¤moduleçš„æ—¶å€™ï¼Œidå°±ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ²¡æœ‰æ”¹è¿‡çš„æ–‡ä»¶çš„idä¹Ÿå˜äº†ï¼Œç¼“å­˜å¤±æ•ˆ)ï¼ŒHashedModuleIdsPluginæ˜¯æŠŠè·¯å¾„hashåŒ–å½“æˆæ¨¡å—id</p> <p>2ã€ä½¿ç”¨NamedChunkPlugin+é­”æ³•æ³¨é‡Šæ¥å›ºå®šä½chunkId</p> <p>åˆ°äº†webpack5.0ï¼ŒmoduleIdå’ŒchunkIdé—®é¢˜éƒ½å¯ä»¥ä¸ç”¨æ’ä»¶è§£å†³ï¼Œç›´æ¥ä½¿ç”¨</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
 optimization<span class="token punctuation">:</span><span class="token punctuation">{</span>
  chunkIds<span class="token punctuation">:</span> <span class="token string">&quot;deterministic&quot;</span><span class="token punctuation">,</span> <span class="token comment">// åœ¨ä¸åŒçš„ç¼–è¯‘ä¸­ä¸å˜çš„çŸ­æ•°å­— id</span>
	moduleIds<span class="token punctuation">:</span> <span class="token string">&quot;deterministic&quot;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿˜æœ‰ä¸€ä¸ªå¾ˆé‡è¦ï¼Œä½†æ˜¯vuecliå´æ²¡å†…ç½®çš„æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯è¦æŠŠå¼•å¯¼æ¨¡æ¿ç»™æå–å‡ºæ¥</p> <p>ä¸ºä»€ä¹ˆè¦æå–ï¼Ÿè¿™è¾¹ç®€å•è¯´ä¸‹</p> <p>æ¯”å¦‚åœ¨vuecliåˆ›å»ºçš„å·¥ç¨‹é¡¹ç›®ä¸­ï¼Œæœ‰ä¸€ä¸ªæ‡’åŠ è½½è·¯ç”±<code>About.vue</code>ï¼Œæ‰“åŒ…å‡ºæ¥ä¼šæœ‰<code>app.contenthash.js</code>å’Œ<code>about.contenthash.js</code>ï¼Œå¦‚æœæˆ‘ä¿®æ”¹äº†<code>About.vue</code>å†…å®¹ï¼Œæ‰“åŒ…å‡ºæ¥çš„<code>about.contenthash.js</code>æ–‡ä»¶hashå¿…ç„¶ä¼šå˜ï¼Œä½†æ˜¯ä½ ä¼šå‘ç°ï¼Œ<code>app.contentHash.js</code>ä¹Ÿè·Ÿç€å˜äº†ï¼Œå¦‚æœåœ¨å¤§å‹é¡¹ç›®ä¸­è¿™æ ·æï¼Œæ”¹äº†ä¸€ä¸ªè·¯ç”±é¡µé¢ï¼Œå¯¼è‡´<code>app.js</code>ä¹Ÿå˜ï¼Œè¿™æ ·å°±ä½¿å¾—<code>app.js</code>ç¼“å­˜å¤±æ•ˆäº†ï¼Œè¿™æ–‡ä»¶è¿˜ä¸å°ã€‚</p> <p>ä¸ºä»€ä¹ˆ<code>app.js</code>ä¼šå˜ï¼Œæ€ä¹ˆè§£å†³ï¼Ÿ</p> <p>è¿™é‡Œæœ‰ä¸ªå¼•å¯¼æ¨¡æ¿çš„æ¦‚å¿µï¼Œä¹Ÿå°±æ˜¯webpackåŠ è½½bundleçš„ä¸€äº›å‰ç½®å‡½æ•°ï¼Œä¾‹å¦‚webpackJsonpCallbackã€webpack-requireã€è¿˜æ˜¯script srcåŠ è½½è¿™äº›ï¼Œè¿™äº›å‡½æ•°æ˜¯ä¸ä¼šå˜çš„ï¼Œä½†æ˜¯é‡Œé¢çš„chunkæ–‡ä»¶æ˜ å°„å…³ç³»ä¼šå˜ï¼Œæ‰€è°“çš„æ˜ å°„å…³ç³»ï¼Œå¯ä»¥çœ‹è¿™ä¸ªå‡½æ•°</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">jsonpScriptSrc</span><span class="token punctuation">(</span>chunkId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> __webpack_require__<span class="token punctuation">.</span>p <span class="token operator">+</span> <span class="token string">&quot;&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span><span class="token operator">||</span>chunkId<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;.&quot;</span> <span class="token operator">+</span> <span class="token punctuation">{</span><span class="token string">&quot;about&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;c19c62a2&quot;</span><span class="token punctuation">}</span><span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">&quot;.js&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œchunkæ–‡ä»¶idå’Œhashå€¼çš„æ˜ å°„éƒ½åœ¨è¿™ä¸ªå‡½æ•°é‡Œé¢ï¼Œæ¯”å¦‚ä¸€ä¸ªchunkå«<code>about.c19c62a2.js</code>ï¼Œåœ¨å¼•å¯¼æ¨¡æ¿ä¸­å°±ä¸º<code>{ about: &quot;c5988801&quot; }</code>ï¼Œæ‰€ä»¥æ¯ä¸ªchunkæ–‡ä»¶çš„idå˜åŠ¨éƒ½ä¼šæ”¹å˜è¿™ä¸ªæ˜ å°„å…³ç³»ï¼Œ<code>About.vue</code>çš„idå˜äº†ï¼Œå½“ç„¶è¿™ä¸ªå¼•å¯¼æ¨¡æ¿æ–‡ä»¶ä¹Ÿä¼šå˜ï¼Œå¼•å¯¼æ¨¡æ¿åˆé»˜è®¤æ”¾åˆ°<code>app.js</code>é‡Œé¢ï¼Œæ‰€ä»¥éœ€è¦æŠŠè¿™ä¸ªå¼•å¯¼æ¨¡æ¿æŠ½å–å‡ºæ¥ï¼Œç‹¬ç«‹åŠ è½½ï¼Œä¸è¦å½±å“<code>app.js</code>çš„hashå€¼</p> <p>è§£å†³æ–¹æ³•ï¼Œwebpackæ·»åŠ ä»¥ä¸‹é…ç½®</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
 	optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
   runtimeChunk<span class="token punctuation">:</span> <span class="token string">'single'</span> <span class="token comment">// true ä¹Ÿå¯ä»¥ï¼Œä¸è¿‡æ¯ä¸ªentry chunkå°±æœ‰ä¸€ä¸ªruntime</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™æ ·å°±å¯ä»¥æŠŠruntimeChunkæ‰“åŒ…å‡ºæ¥ï¼Œ<code>app.js</code>ä¸ä¼šå› ä¸º<code>about.js</code>å˜åŒ–è€Œæ”¹å˜</p> <p>ä½†æ˜¯è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œè¿™ä¸ªchunkå¾ˆå°ï¼Œæ²¡å¿…è¦æ¶ˆè€—ä¸€æ¬¡httpè¯·æ±‚ï¼Œä¸ç„¶è¯·æ±‚æ—¶é—´ä¼šå¤§äºåŠ è½½æ—¶é—´ï¼Œæ‰€ä»¥ç›´æ¥å†…è”åˆ°htmlæ¨¡æ¿é‡Œé¢å°±å¯ä»¥äº†</p> <p>å¯ä»¥ç”¨<code>script-ext-html-webpack-plugin</code>æ’ä»¶å®ç°</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> ScriptExtHtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'script-ext-html-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  productionSourceMap<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  configureWebpack<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      runtimeChunk<span class="token punctuation">:</span> <span class="token string">'single'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">ScriptExtHtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        inline<span class="token punctuation">:</span> <span class="token regex">/runtime.+\.js$/</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  chainWebpack<span class="token punctuation">:</span> config <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">'preload'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>args <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fileBlacklist<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token regex">/runtime.+\.js$/</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> args
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="å¦‚æœè·å–é¡µé¢fpå’Œfcpçš„æ—¶é—´"><a href="#å¦‚æœè·å–é¡µé¢fpå’Œfcpçš„æ—¶é—´" aria-hidden="true" class="header-anchor">#</a> å¦‚æœè·å–é¡µé¢FPå’ŒFCPçš„æ—¶é—´</h3> <p>FP(é¦–æ¬¡ç»˜åˆ¶)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fp <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">getEntriesByType</span><span class="token punctuation">(</span><span class="token string">'paint'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>startTime<span class="token punctuation">;</span>
</code></pre></div><p>FCP(é¦–æ¬¡å†…å®¹ç»˜åˆ¶)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fcp <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">getEntriesByType</span><span class="token punctuation">(</span><span class="token string">'paint'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>startTime<span class="token punctuation">;</span>
</code></pre></div><div class="to-top"><svg t="1547627942927" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1955" xmlns:xlink="http://www.w3.org/1999/xlink" width="64" height="64" class="icon"><path d="M752.736 431.063C757.159 140.575 520.41 8.97 504.518 0.41V0l-0.45 0.205-0.41-0.205v0.41c-15.934 8.56-252.723 140.165-248.259 430.653-48.21 31.457-98.713 87.368-90.685 184.074 8.028 96.666 101.007 160.768 136.601 157.287 35.595-3.482 25.232-30.31 25.232-30.31l12.206-50.095s52.47 80.569 69.304 80.528c15.114-1.23 87-0.123 95.6 0h0.82c8.602-0.123 80.486-1.23 95.6 0 16.794 0 69.305-80.528 69.305-80.528l12.165 50.094s-10.322 26.83 25.272 30.31c35.595 3.482 128.574-60.62 136.602-157.286 8.028-96.665-42.475-152.617-90.685-184.074z m-248.669-4.26c-6.758-0.123-94.781-3.359-102.891-107.192 2.95-98.714 95.97-107.438 102.891-107.93 6.964 0.492 99.943 9.216 102.892 107.93-8.11 103.833-96.174 107.07-102.892 107.192z m-52.019 500.531c0 11.838-9.42 21.382-21.012 21.382a21.217 21.217 0 0 1-21.054-21.34V821.74c0-11.797 9.421-21.382 21.054-21.382 11.591 0 21.012 9.585 21.012 21.382v105.635z m77.333 57.222a21.504 21.504 0 0 1-21.34 21.626 21.504 21.504 0 0 1-21.34-21.626V827.474c0-11.96 9.543-21.668 21.299-21.668 11.796 0 21.38 9.708 21.38 21.668v157.082z m71.147-82.043c0 11.796-9.42 21.34-21.053 21.34a21.217 21.217 0 0 1-21.013-21.34v-75.367c0-11.755 9.421-21.299 21.013-21.299 11.632 0 21.053 9.544 21.053 21.3v75.366z" fill="#3eaf7c" p-id="1956"></path></svg></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">1/10/2021, 10:11:46 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/Notebook/dailyRecord/2021.html" class="prev">
        2021
      </a></span> <span class="next"><a href="/Notebook/dailyRecord/2019.html">
        2019
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Notebook/assets/js/app.51035dcd.js" defer></script><script src="/Notebook/assets/js/21.b8066a1d.js" defer></script><script src="/Notebook/assets/js/15.b864e6b5.js" defer></script><script src="/Notebook/assets/js/19.17673ac2.js" defer></script>
  </body>
</html>
