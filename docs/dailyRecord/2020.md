# 2020

## ä¸€æœˆ

### è¿è¡Œæ—¶è®¾ç½® webpack çš„ publicPath

`publicPath` æ˜¯ webpack æä¾›çš„é…ç½®å…¬å…±è·¯å¾„çš„åœ°æ–¹ï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥æŒ‡å®šåº”ç”¨ç¨‹åºä¸­æ‰€æœ‰èµ„æºçš„åŸºç¡€è·¯å¾„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è¿è¡Œæ—¶è®¾ç½®`publicPath`ï¼Œå¯ä»¥é€šè¿‡åŠ¨æ€è®¾ç½®`__webpack_public_path__`æ¥å®ç°

åœ¨`app.js`ä¸­ï¼š

```js
__webpack_public_path__ = '/public/';

// æ‰“åŒ…åå¯¹åº”çš„å˜é‡å
__webpack_require__.p = '/public/';
```

åœ¨æ‰“åŒ…åï¼Œä¼šæœ‰ä¸€ä¸ª`__webpack_require__.p`å˜é‡æ¥ä¿å­˜æœ€æ–°è®¾ç½®çš„å€¼

## äºŒæœˆ

### å¤§æ–‡ä»¶ä¸Šä¼ åˆ‡ç‰‡æ–¹æ³•

å‰ç«¯ä¸Šä¼ æ‰“æ–‡ä»¶çš„æ—¶å€™ï¼Œä¸€èˆ¬éƒ½ä¼šç”¨åˆ‡ç‰‡ä¸Šä¼ çš„æ–¹å¼ï¼Œæ ¸å¿ƒä¸»è¦æ˜¯ç”¨`Blob.prototype.slice`è¿›è¡Œåˆ‡ç‰‡ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥è¿”å›ä¸€ä¸ªæ–°çš„åˆ‡ç‰‡`Blob`å¯¹è±¡ï¼Œå‰ç«¯å¤„ç†è¿™ä¹ˆå†™ï¼š

```js
function createFileChunk(file, size = 1 * 1024 * 1024) {
  const fileChunkList = [];
  let cur = 0;
  while (cur < file.size) {
    fileChunkList.push({
      // åˆ©ç”¨ Blob.prototype.slice åˆ‡ç‰‡
      file: file.slice(cur, cur + size),
    });
    cur += size;
  }
  return fileChunkList;
}
```

### JavaScript åˆ¤æ–­æ•´å‹çš„æ–¹æ³•

es5ï¼š

```js
function isInteger(x) {
  return parseInt(x, 10) === x;
}
```

es6ï¼š

```js
function isInteger(x) {
  return Number.isInteger(x);
}
```

### å¦‚ä½•åœ¨ html ä¸Šå®ç°é‡å®šå‘ï¼Ÿ

ä½¿ç”¨`meta content url`æ–¹æ³•ï¼Œ`http-equiv="refresh"`å®šä¹‰æ–‡æ¡£è‡ªåŠ¨åˆ·æ–°çš„æ—¶é—´é—´éš”(å¤šå°‘ç§’)ï¼Œè®¾ç½®åœ¨`content`é‡Œ`url`çš„å‰é¢

```html
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="refresh" content="0;url=xxx" />
  </head>
  <body></body>
</html>
```

## ä¸‰æœˆ

### docker nginx å®¹å™¨å¦‚ä½•è®¿é—®å®¿ä¸»æœº

åœ¨ç”¨ docker nginx è¿›è¡Œåå‘ä»£ç†æœ¬åœ°ä¸€äº›æœåŠ¡çš„æ—¶å€™ï¼Œé»˜è®¤ç”¨ localhost æ˜¯ç›´æ¥è®¿é—®å®¹å™¨çš„æœ¬èº«ï¼Œæ‰€ä»¥è¦åœ¨ nginx çš„ conf æ–‡ä»¶ä¸­é…ç½®æŒ‡å®šçš„ ip åœ°å€ï¼Œä½†æ˜¯ç½‘ç»œåˆ‡æ¢çš„è¯ï¼Œip ä¼šå˜ï¼Œæ‰€ä»¥åªèƒ½ä¿®æ”¹é…ç½®æ–‡ä»¶è¿›è¡Œé‡å¯è¿™ä¸ªå®¹å™¨ï¼Œå…¶å®ä¸æ–¹ä¾¿ï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥çœå»è¿™æ­¥éª¤å‘¢ï¼Ÿ

- åœ¨ mac desktop ç¯å¢ƒä¸­ï¼Œå¯ä»¥ç”¨`host.docker.internal`æ¥è·å–åˆ°å®¿ä¸»æœºçš„ ip åœ°å€
- åœ¨ linux ç¯å¢ƒä¸­ï¼Œå¯ä»¥`--network host`æ¨¡å¼å¯åŠ¨å®¹å™¨

åœ¨ mac ç¯å¢ƒä¸­ï¼Œnginx çš„ conf æ–‡ä»¶ä¸­å¯ä»¥è¿™ä¹ˆå†™äº†ï¼š

```
location / {
  proxy_pass http://host.docker.internal:5505/;
}
```

### vscode vue æ–‡ä»¶ä¸­æ— æ³•è¯†åˆ«"@/xxx"æ–‡ä»¶è·¯å¾„

ä½¿ç”¨ `jsconfig.json` è§£å†³

```json
{
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"],
      "g6/*": ["./src/g6/*"]
    },
    "target": "ES6",
    "module": "commonjs",
    "allowSyntheticDefaultImports": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules"]
}
```

### ä½¿ç”¨å¯¹è±¡å¡«å……æ•°ç»„

```js
const length = 3;
const resultA = Array.from({ length }, () => ({}));
const resultB = Array(length).fill({});

resultA; // => [{}, {}, {}]
resultB; // => [{}, {}, {}]

resultA[0] === resultA[1]; // => false
resultB[0] === resultB[1]; // => true
```

ç”±æ­¤å¯è§ï¼Œç”¨`Array.from`æ¯”`fill`æ–¹æ³•æ›´å¥½ï¼Œå¯ä»¥é¿å…ç”±äºç›¸åŒå¯¹è±¡å¼•èµ·çš„ä¸€äº›éº»çƒ¦ã€‚

## å››æœˆ

### å¦‚ä½•è®¾è®¡ä¸€ä¸ªåŒæ—¶æ”¯æŒå…·åæ’æ§½å’Œé»˜è®¤æ’æ§½çš„ vue ç»„ä»¶

å¦‚æœæƒ³è¦å¼€å‘ä¸€ä¸ªåŒæ—¶æ”¯æŒå…·ä½“æ’æ§½å’Œé»˜è®¤æ’æ§½çš„ vue ç»„ä»¶ï¼Œå…³é”®åœ¨äºå¦‚ä½•åˆ¤æ–­ç»„ä»¶æ˜¯å¦ä½¿ç”¨äº†é»˜è®¤æ’æ§½ï¼Œä¹Ÿå°±æ˜¯åŠ ä¸ªåˆ¤æ–­ï¼š

```js
computed: {
  hasSlotDefault() {
    // ç»„ä»¶å†…å¦‚æœæ²¡å†…å®¹ï¼Œ$slots.default ä¸º undefined
    return !!this.$slots.default;
  }
},
```

æ¨¡æ¿å†™æ³•ï¼š

```html
<div class="project-main">
  <template v-if="!hasSlotDefault">
    <div class="menu">
      <slot name="menu"></slot>
    </div>
    <div class="module">
      <slot name="module"></slot>
    </div>
  </template>
  <template v-else>
    <slot></slot>
  </template>
</div>
```

### å¦‚ä½•åœ¨ .eslintrc.js ä¸­é…ç½® prettier è§„åˆ™

```js
rules: {
  'prettier/prettier': ['error', { singleQuote: true }]
}
```

### ä½¿ç”¨ emoji è®¾ç½® ç½‘é¡µçš„ favicon çš„æ–¹æ³•

```js
const setFavicon = function(url) {
  const favicon = document.querySelector('link[rel="icon"]');
  if (favicon) {
    favicon.href = url;
  } else {
    const link = document.createElement('link');
    link.rel = 'icon';
    link.href = url;

    document.head.appendChild(link);
  }
};

const emojiFavicon = function(emoji) {
  const canvas = document.createElement('canvas');
  canvas.height = 64;
  canvas.width = 64;

  const context = canvas.getContext('2d');
  context.font = '64px serif';
  context.fillText(emoji, 0, 64);

  const url = canvas.toDataURL();

  setFavicon(url);
};

// Usage
emojiFavicon('ğŸ‰');
```

### è®¡ç®— scrollbar å®½åº¦çš„æ–¹æ³•

```js
const calculateScrollbarWidth = function() {

  const outer = document.createElement('div');
  outer.style.visibility = 'hidden';
  outer.style.overflow = 'scroll';

  document.body.appendChild(outer);

  const inner = document.createElement('div');
  outer.appendChild(inner);

  // é‡Œå¤–å®½åº¦ç›¸å‡å¾—å‡ºæ»šåŠ¨æ¡çš„å®½åº¦
  const scrollbarWidth = outer.offsetWidth - inner.offsetWidth;

  document.body.removeChild(outer);

  return scrollbarWidth;
};
```
